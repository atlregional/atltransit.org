{"version":3,"sources":["planner-widget.js","utilities.js","locale.js","nav.js","schedules-widget.js"],"names":["getEsriGeometry","option","id","$","ajax","url","esriUrl","dataType","data","text","magicKey","f","success","console","log","geom","locations","feature","geometry","val","y","x","compareRouteNames","a","b","shortName","findBootstrapEnvironment","envs","$el","appendTo","i","length","env","addClass","is","remove","setupDatetime","pad","n","hide","attr","setTime","currentTime","date","year","month","setDate","datepicker","dateFormat","Locale","dayNames","days","dayNamesMin","daysMin","monthNames","months","defaultDate","hideIfNoPrevNext","minDate","whitelabel_minDate","maxDate","whitelabel_maxDate","document","on","this","parents","iso8601","parts","split","d","moment","format","input","getDate","getTime","time","scrollToAnchor","aid","aTag","scrollToOffset","offset","top","animate","scrollTop","equalHeight","group","tallest","each","css","height","thisHeight","trimHeadsign","headsign","replace","toTitleCase","cleanStopName","name","getDistanceFromLatLonInKm","lat1","lon1","lat2","lon2","R","dLat","deg2rad","dLon","Math","sin","cos","c","atan2","sqrt","deg","PI","str","txt","test","toLowerCase","charAt","toUpperCase","substr","whitelabel_prefix","Date","timeFormat","dateAriaLabel","loading","edit","plan","geocoderInput","originInput","destinationInput","startpointEmpty","noStartpointSelected","destinationEmpty","noDestinationSelected","noValidDate","noValidTime","dateTooEarly","minDate8601","reverse","join","dateTooLate","maxDate8601","from","via","to","earlier","later","noAdviceFound","walk","platformrail","platform","amountTransfers","transfers","autocompleteMessages","noResults","results","amount","submit","e","preventDefault","value","tooltip","click","$this","removeClass","shiftContent","marginTop","geolocationBool","lat","lon","labelMap","RED","BLUE","GOLD","GREEN","MARTA","CCT","GCT","GRTA","timepicker","carousel","interval","urlParams","dropdown","setupAutoComplete","jQuery","unparam","window","location","hash","tab","trigger","stopId","setTimeout","change","select2","allowClear","delay","term","page","distance","searchExtents","res","suggestions","array","item","arrItem","push","cache","minimumInputLength","templateResult","templateSelection","routeTypeMap","0","1","2","3","4","5","6","7","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","error","code","PERMISSION_DENIED","params","key","serialize","json","list","agencies","agency","agencyId","removeAttr","widgetClass","hasClass","index","html","prop","routeNest","d3","nest","type","sortValues","map","routes","optgroup","route","routeFullText","longName","routeText","append","unix","radius","firstValue","agencyCount","routeId","includePolylines","selectedTrip","closestDistance","closestStop","stopGroups","entry","stopGroupings","stopMap","references","stops","tripMap","tripCounter","trip","tripLabel","tripOption","stopIds","j","stop","stopName","stopDir","direction","$stops","previousTrip","tableId","table","stopCode","query","show","minutesBefore","arrivals","arrivalsAndDepartures","lastUpdateTime","empty","tbody","predicted","predictedArrivalTime","seconds","scheduledArrivalTime","diff","valueOf","routeName","routeShortName","fromNow","floor","fromNowText","tripHeadsign","patt","RegExp","row","fn","dataTable","isDataTable","arrivalsDatatable","DataTable","destroy","order","paging","info","bFilter","plannerChoice","origin","destination","fadeIn","fadeOut","saddr","daddr","dirflg","googUrl","open","fromPlace","toPlace","arriveBy","fromName","toName","mode","atltransitUrl","href","toggleClass","stopRouteSchedules","routeMap","schedulesDiv","rowDiv","rowDiv2","directions","stopRouteDirectionSchedules","numTrips","gridWidth","columnDiv","scheduleFrequencies","scheduleStopTimes","minuteCell","stopTimes","firstTime","arrivalTime","currentHour","morning","hour","k","meridian","nextArrivalTime","arrivalTimeMinutes","minutes","history","pushState","reveal","args","Array","prototype","slice","call","arguments","img","src","load","apply","splice","ready","waitForFinalEvent","timers","callback","ms","uniqueId","clearTimeout","resize","substring","pair","l","pieces","decodeURIComponent","extend","disable","state","disabled","obj","prefix","p","hasOwnProperty","v","encodeURIComponent","bs"],"mappings":"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","file":"atltransit.js","sourcesContent":["var geolocationBool = false\nvar lat, lon\nvar labelMap = {\n  'RED': 'label label-danger',\n  'BLUE': 'label label-primary',\n  'GOLD': 'label label-warning',\n  'GREEN': 'label label-success',\n  'MARTA': 'label label-orange',\n  'CCT': 'label label-magenta',\n  'GCT': 'label label-maroon',\n  'GRTA': 'label label-cyan',\n}\n\n// window.onload = function(){\n// Planner Widget Javascript\n$('#planner-timepicker').timepicker()\n$('#test-carousel, #next-carousel, #schedules-carousel').carousel({\n  interval: false\n})\n$('#next-arrivals-agencies').val('')\n\n// var Locale = {}\n// Locale.autocompleteMessages = {\n//         noResults: \"No results found.\",\n//         results: function( amount ) {\n//             return amount + ( amount > 1 ? \" results are \" : \" result is\" ) + \" available, use the up and down arrow keys to navigate them.\"\n//         }\n// }\n\nvar esriUrl = 'https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/'\nfunction getEsriGeometry (option, id) {\n  $.ajax({\n    url: esriUrl + 'find?',\n    dataType: 'jsonp',\n    // delay: 250,\n    data: {\n      text: option.text, // search term\n      magicKey: option.id,\n      // outFields: 'City,Region',\n      f: 'pjson',\n    // distance: 20000,\n    // searchExtents: -'85.386,34.618,-83.269,32.844',\n    // location: '-84.383149,33.750855',\n    },\n    success: function (data) {\n      console.log(data)\n      var geom = data.locations[0].feature.geometry\n      $('.planner-form input[name=' + id + 'Place]').val(geom.y + ',' + geom.x)\n    }\n  })\n}\n\nvar urlParams\n$(function () {\n  $('.dropdown-toggle').dropdown()\n\n  // // load stop ids\n  // var url = 'http://atlanta.onebusaway.org/api/api/where/stop-ids-for-agency/MARTA.json?'\n  // var params = {}\n  // // params.query = stopCode\n  // params.key = 'TEST'\n  // url += serialize(params)\n  // $.ajax({\n  // \turl: url,\n  // \tdataType: 'jsonp',\n  // \tsuccess: function(json){\n  // \t\tconsole.log(json.data)\n  // \t\tif (json.data.list.length > 0){\n  // \t\t\tstopId = json.data.list[0].id\n\n  // \t\t}\n  // \t}\n  // })\n  if (typeof setupAutoComplete === 'function') {\n    setupAutoComplete()\n  }\n\n  urlParams = jQuery.unparam(window.location.hash)\n  // console.log(params);{}\n  if (typeof urlParams.tab !== 'undefined') {\n    $('#' + urlParams.tab + '-link').trigger('click')\n    if (typeof urlParams.stopId !== 'undefined') {\n      window.setTimeout(function () {\n        $('#' + urlParams.tab + '-arrivals-btn')\n          .removeClass('disabled')\n          .val(urlParams.stopId)\n          .trigger('click')\n      }, 200)\n\n    // $(' .stop-code').trigger('click')\n    }\n  }\n  $('.js-data-example-ajax').change(function () {\n    console.log(this.value)\n    console.log($(this).select2('data'))\n    var data = $(this).select2('data') // $(this).select2('data')[0]\n    getEsriGeometry(data, this.id)\n  })\n  $('.js-data-example-ajax').select2({\n    // placeholder: \"From\",\n    allowClear: true,\n    ajax: {\n      url: esriUrl + 'suggest?',\n      dataType: 'jsonp',\n      delay: 250,\n      data: function (term, page) {\n        return {\n          text: term, // search term\n          // page: params.page,\n          // outFields: 'City,Region',\n          f: 'json',\n          distance: 20000,\n          searchExtents: '-85.386,34.618,-83.269,32.844',\n          location: '-84.383149,33.750855',\n        }\n      },\n      results: function (data, page) {\n        console.log(data)\n        // parse the results into the format expected by Select2.\n        // since we are using custom formatting functions we do not need to\n        // alter the remote JSON data\n        var res = data.suggestions\n        var array = []\n        $.each(res, function (i, item) {\n          var arrItem = {\n            id: item.magicKey,\n            text: item.text\n          }\n          array.push(arrItem)\n        })\n        return {\n          results: array\n        }\n      },\n      cache: true\n    },\n    // escapeMarkup: function (markup) { return markup; }, // let our custom formatter work\n    minimumInputLength: 3,\n    templateResult: function (option) {\n      return '<div class=\"clearfix\">' + option.text + '</div>'\n    },\n    templateSelection: function (option) {\n      return option.text\n    }\n  })\n  var routeTypeMap = {\n    '0': 'Tram',\n    '1': 'Subway',\n    '2': 'Rail',\n    '3': 'Bus',\n    '4': 'Ferry',\n    '5': 'Cable',\n    '6': 'Gondola',\n    '7': 'Funicular'\n  }\n  // Geolocation\n  if ('geolocation' in navigator) {\n    /* geolocation is available */\n    console.log('geolocation')\n    console.log(navigator)\n\n    // Check if geolocation is enabled\n    navigator.geolocation.getCurrentPosition(function (position) {\n      geolocationBool = true\n      lat = position.coords.latitude\n      lon = position.coords.longitude\n      console.log([position.coords.latitude, position.coords.longitude])\n    }, function (error) {\n      if (error.code == error.PERMISSION_DENIED)\n        console.log('you denied me :-(')\n    })\n  } else {\n    /* geolocation IS NOT available */\n  }\n  // Check if agency data exists\n  var url = 'http://atlanta.onebusaway.org/api/api/where/agencies-with-coverage.json?'\n  var params = {}\n  // params.id = agencyId\n  params.key = 'TEST'\n  url += serialize(params)\n  $.ajax({\n    url: url,\n    dataType: 'jsonp',\n    success: function (json) {\n      console.log(json.data.list)\n      var agencies = json.data.list\n      $.each(agencies, function (i, agency) {\n        $('.arrivals-agencies option[value=' + agency.agencyId + ']').removeAttr('disabled')\n      })\n    }\n  }) // end ajax\n\n  // Go back to previous view on planner widget carousels\n  $('.planner-tab-li').click(function (e) {\n    var widgetClass\n    if ($(this).hasClass('stop-code')) {\n      widgetClass = 'stop-code'\n    } else {\n      widgetClass = 'next'\n    }\n    if ($(this).hasClass('active') && $('#' + widgetClass + '-carousel-inner > .active').index() === 1) {\n      // console.log('this is active')\n      $('#' + widgetClass + '-back-btn').trigger('click')\n    }\n  })\n\n  // Real-time agency select change\n  $('input[type=radio][name=agency-arrivals-option], #next-arrivals-agencies').change(function () {\n    $('#next-arrivals-routes').html('<option value=\"\">[Select Route]</option>')\n    $('#next-arrivals-trips')\n      .html('<option value=\"\">[Select Direction]</option>')\n      .prop('disabled', true)\n    $('#next-arrivals-stops')\n      .html('<option value=\"\">[Select Stop]</option>')\n      .trigger('change')\n      .prop('disabled', true)\n    console.log(this.value)\n    if (this.value === 'Nearby') {\n      $('#get-location').trigger('click')\n      return true\n    }\n    var agencyId = this.value\n    location.hash = 'agency=' + agencyId\n    var url = 'http://atlanta.onebusaway.org/api/api/where/routes-for-agency/' + agencyId + '.json?'\n    var params = {}\n    // params.id = agencyId\n    params.key = 'TEST'\n    url += serialize(params)\n    $.ajax({\n      url: url,\n      dataType: 'jsonp',\n      success: function (json) {\n        console.log(json.data)\n        var routeNest = d3.nest()\n          .key(function (d) { return d.type; })\n          .sortValues(compareRouteNames)\n          .map(json.data.list)\n        console.log(routeNest)\n        var routes = json.data.list\n        $.each(routeNest, function (type, routes) {\n          var optgroup = $('<optgroup>')\n          optgroup.attr('label', routeTypeMap[type])\n          $.each(routes, function (i, route) {\n            var option = $('<option></option>')\n            var routeFullText = routeTypeMap[type] === 'Subway' ? route.shortName : route.shortName + ' - ' + route.longName\n            var routeText = route.longName === '' ? route.shortName : routeFullText\n            option.val(route.id)\n            option.text(routeText)\n            optgroup.append(option)\n          })\n          $('#next-arrivals-routes').append(optgroup)\n        })\n        $('#next-arrivals-routes').prop('disabled', false)\n      }\n    }) // end ajax\n  })\n  // Use location \n  $('#get-location').click(function () {\n    $('#next-arrivals-agencies').val('Nearby')\n    $('#next-arrivals-routes').html('<option value=\"\">[Select Route]</option>')\n    $('#next-arrivals-stops')\n      .html('<option value=\"\">[Select Stop]</option>')\n      .trigger('change')\n      .prop('disabled', true)\n    $('#next-arrivals-trips')\n      .html('<option value=\"\">[Select Direction]</option>')\n      .prop('disabled', true)\n    $(this).val(moment().unix())\n    if (geolocationBool && typeof lat !== 'undefined') {\n      var url = 'http://atlanta.onebusaway.org/api/api/where/routes-for-location.json?'\n      var params = {}\n      params.lat = lat\n      params.lon = lon\n      params.radius = 4000\n      params.key = 'TEST'\n      url += serialize(params)\n      $.ajax({\n        url: url,\n        dataType: 'jsonp',\n        success: function (json) {\n          console.log(json.data)\n          var routeNest = d3.nest()\n            .key(function (d) { return d.agencyId; })\n            .map(json.data.list)\n          console.log(routeNest)\n          var agencyCount = 0\n          var firstValue\n          $.each(routeNest, function (agency, routes) {\n            var optgroup = $('<optgroup>')\n            optgroup.attr('label', agency)\n            $.each(routes, function (i, route) {\n              var option = $('<option></option>')\n              if (agencyCount === 0 || i === 0) {\n                firstValue = route.id\n              }\n              var routeFullText = routeTypeMap[route.type] === 'Subway' ? route.shortName : route.shortName + ' - ' + route.longName\n              var routeText = route.longName === '' ? route.shortName : routeFullText\n              option.val(route.id)\n              option.text(routeText)\n              optgroup.append(option)\n            })\n            $('#next-arrivals-routes').append(optgroup)\n            agencyCount++\n          })\n          // $('#next-arrivals-routes').val(firstValue)\n          $('#next-arrivals-routes').prop('disabled', false)\n        }\n      })\n    } else {\n      console.log('no geolocation available')\n    }\n  })\n  // Select route change\n  $('#next-arrivals-routes').change(function () {\n    var widgetClass\n    if ($(this).hasClass('nearby')) {\n      widgetClass = 'nearby'\n    } else {\n      widgetClass = 'next'\n    }\n    $('#next-arrivals-stops')\n      .html('<option value=\"\">[Select Stop]</option>')\n      .trigger('change')\n      .prop('disabled', true)\n    $('#next-arrivals-trips').html('<option value=\"\">[Select Direction]</option>')\n    console.log(this.value)\n    var routeId = this.value\n    location.hash += '&route=' + routeId\n    var url = 'http://atlanta.onebusaway.org/api/api/where/stops-for-route/' + routeId + '.json?'\n    var params = {}\n    params.key = 'TEST'\n    params.includePolylines = false\n    url += serialize(params)\n    $.ajax({\n      url: url,\n      dataType: 'jsonp',\n      success: function (json) {\n        var closestDistance = 10000000000\n        var closestStop = ''\n        var selectedTrip\n        var stopGroups = json.data.entry.stopGroupings[0].stopGroups\n        console.log(json.data.entry.stopGroupings[0].stopGroups)\n        console.log(json.data)\n        var stopMap = d3.nest()\n          .key(function (d) { return d.id; })\n          .map(json.data.references.stops)\n        var tripMap = d3.nest()\n          // .key(function(d) { return d.name.name; })\n          // .key(function(d) { return d.tripHeadsign; })\n          .key(function (d) { return d.id; })\n          .map(stopGroups)\n        console.log(stopMap)\n        console.log(tripMap)\n        console.log(routeId)\n        // console.log(tripMap[routeId])\n        var headsigns = []\n        var tripCounter = 0\n        $.each(stopGroups, function (i, trip) {\n          // var tripId = trip.tripId\n          // console.log(trip.schedule.stopTimes)\n\n          // if (typeof tripMap[routeId][tripId] !== 'undefined' && tripMap[routeId][tripId][0].routeId === routeId && headsigns.indexOf(tripMap[routeId][tripId][0].tripHeadsign) === -1){\n          // var headsign = tripMap[routeId][tripId][0].tripHeadsign\n          // headsigns.push(headsign)\n          var tripLabel = trip.name.name === '' ? trip.id : trimHeadsign(trip.name.name)\n          tripLabel = +tripLabel === 1 ? 'Inbound' : tripLabel\n          tripLabel = +tripLabel === 0 ? 'Outbound' : tripLabel\n          console.log(tripLabel)\n          var tripOption = $('<option></option>')\n          tripOption.val(trip.id)\n          tripOption.text(tripLabel)\n          $('#next-arrivals-trips').append(tripOption)\n          var optgroup = $('<optgroup>')\n          optgroup.attr('id', trip.id)\n          optgroup.attr('label', tripLabel)\n          if (tripCounter === 0) {\n            selectedTrip = trip.id\n          } else {\n            optgroup.addClass('hidden-optgroup')\n          }\n\n          $.each(trip.stopIds, function (j, stopId) {\n            var stop = stopMap[stopId][0]\n            // console.log(stop)\n            var distance = ''\n            if (typeof lat !== 'undefined' && geolocationBool) {\n              distance = getDistanceFromLatLonInKm(stop.lat, stop.lon, lat, lon)\n\n              if (tripCounter === 0) {\n                if (distance < closestDistance) {\n                  closestDistance = distance\n                  closestStop = stop.id\n                }\n              }\n            }\n            var option = $('<option></option>')\n            option.val(stop.id)\n            if (geolocationBool && typeof lat != 'undefined') {\n              option.attr('distance', distance)\n            }\n            var stopName = cleanStopName(stop.name)\n            var stopDir = stop.direction !== '' ? '(' + stop.direction + ') ' : ''\n            option.text(stopDir + stopName)\n            optgroup.append(option)\n          // $('#' + widgetClass + '-arrivals-stops').append(option)\n          })\n\n          $('#' + widgetClass + '-arrivals-stops').append(optgroup)\n          tripCounter++\n          // } // end if valid trip for route\n\n        }) // end each trip\n        var $stops = $('#next-arrivals-stops')\n        $('#next-arrivals-trips').prop('disabled', false)\n        $('#next-arrivals-trips').val(selectedTrip)\n        $stops.prop('disabled', false)\n        if (geolocationBool && typeof lat !== 'undefined') {\n          $stops.val(closestStop)\n        }\n        if ($stops.val() !== '') {\n          $stops.trigger('change')\n        }\n        if ($('#next-arrivals-stops').val() !== '') {\n          $('#next-arrivals-btn').prop('disabled', false)\n        } else {\n          $('#next-arrivals-btn').prop('disabled', true)\n        }\n      } // end success\n    }) // end ajax\n  })\n  // $('.arrivals-routes').change(function(){\n  // })\n  var previousTrip\n  $('#next-arrivals-trips')\n    .on('focus', function () {\n      // Store the current value on focus and on change\n      previousTrip = this.value\n    }).change(function () {\n    var closestDistance = 10000000000\n    var closestStop = ''\n    console.log(this.value)\n    $('#' + previousTrip).addClass('hidden-optgroup')\n    $('#' + this.value).removeClass('hidden-optgroup')\n    if (geolocationBool) {\n      $('#' + this.value + ' > option').each(function () {\n        var distance = $(this).attr('distance')\n        console.log(distance)\n        if (distance < closestDistance) {\n          closestDistance = distance\n          closestStop = this.value\n        }\n      })\n    }\n    console.log(closestStop)\n    var $stops = $('#next-arrivals-stops')\n    if (closestStop !== '') {\n      $stops.val(closestStop)\n      if ($stops.val() !== '') {\n        $stops.trigger('change')\n      }\n    }\n\n  })\n  $('#next-arrivals-stops').change(function () {\n    var stopId = this.value\n    console.log(stopId)\n    if (stopId !== '') {\n      $('#next-arrivals-btn')\n        .removeClass('disabled')\n        .removeAttr('disabled')\n        .val(stopId)\n\n      location.hash += '&stop=' + stopId\n\n      $('.get-schedules').removeClass('disabled')\n    } else {\n      $('#next-arrivals-btn')\n        .addClass('disabled')\n        .attr('disabled', 'disabled')\n        .val('')\n      $('.get-schedules').addClass('disabled')\n    }\n  })\n  $('#stop-code').on('keyup', function (e) {\n    var tableId = '#stop-code-arrivals-table'\n    var table = $(tableId)\n\n    var stopCode = $('#stop-code').val() === '' ? '103134' : $('#stop-code').val()\n    if (this.value.length < 6) {\n      console.log(this.value)\n      $('#stop-code-error-msg').html('Please enter a valid <strong>six-digit</strong> stop ID.')\n      $('#stop-code-arrivals-btn')\n        .addClass('disabled')\n        .val('')\n    }\n    else if (this.value.length === 6) {\n      console.log(e)\n      console.log(this.value)\n      var url = 'http://atlanta.onebusaway.org/api/api/where/stops-for-location.json?'\n      var params = {}\n      params.query = stopCode\n      params.key = 'TEST'\n      url += serialize(params)\n      $.ajax({\n        url: url,\n        dataType: 'jsonp',\n        success: function (json) {\n          console.log(json.data)\n          if (json.data.list.length > 0) {\n            stopId = json.data.list[0].id\n            stopName = cleanStopName(json.data.list[0].name)\n            // $('.get-next-stop-code').removeClass('btn-danger').addClass('btn-primary')\n            $('#stop-code-arrivals-btn')\n              .removeClass('disabled')\n              .val(stopId)\n            $('#stop-code-error-msg').html('Stop: <strong>' + stopName + '</strong>')\n          } else {\n            table.hide()\n            $('#nearby-arrival-msg').text('No arrivals.')\n            $('#nearby-arrival-msg').show()\n            $('#stop-code-error-msg').html('Unknown stop ID.')\n            $('#stop-code-arrivals-btn')\n              .addClass('disabled')\n              .val('')\n          // $('.get-next-stop-code').removeClass('btn-primary').addClass('btn-danger')\n          }\n        }\n      })\n    } // end if stop code length === 6\n    else {\n      $('#stop-code-arrivals-btn')\n        .addClass('disabled')\n        .val('')\n      $('#stop-code-error-msg').html('Please enter a valid <strong>six-digit</strong> stop ID.')\n    }\n  })\n  $('.get-arrivals').click(function () {\n    var widgetClass, stopId\n\n    if ($(this).hasClass('stop-code')) {\n      widgetClass = 'stop-code'\n    } else {\n      widgetClass = 'next'\n    }\n    var tableId = '#' + widgetClass + '-arrivals-table'\n    var table = $(tableId)\n    stopId = $('#' + widgetClass + '-arrivals-btn').val()\n\n    console.log(stopId)\n    console.log(widgetClass)\n    if (stopId !== '') {\n      // console.log('stop coding it up')\n      var url = 'http://atlanta.onebusaway.org/api/api/where/arrivals-and-departures-for-stop/' + stopId + '.json?'\n      var params = {}\n      params.key = 'TEST'\n      params.minutesBefore = 1\n      url += serialize(params)\n      $.ajax({\n        url: url,\n        dataType: 'jsonp',\n        success: function (json) {\n          var arrivals = json.data.entry.arrivalsAndDepartures\n          console.log(json.data)\n          var stopMap = d3.nest()\n            .key(function (d) { return d.id; })\n            .map(json.data.references.stops)\n\n          console.log(json.data.entry.arrivalsAndDepartures)\n          if (arrivals.length > 0) {\n            stopName = stopMap[json.data.entry.stopId][0].name\n            $('#' + widgetClass + '-stop-id').html(cleanStopName('Stop ID: ' + stopId.split('_')[1]))\n            $('#' + widgetClass + '-stop-name').html(cleanStopName(stopName))\n            $('#' + widgetClass + '-last-updated .time').html(moment(arrivals[0].lastUpdateTime).format('h:mm a'))\n            $('#nearby-arrival-msg').hide()\n            table.show()\n            table.empty()\n\n            // var header = $('<thead>')\n            // header.append('<tr><')\n            table.append('<thead><tr><th>Route</th><th>Minutes</th><th>Direction</th></tr></thead>')\n            var tbody = $('<tbody>')\n            var data = []\n            for (var i = 0; i < arrivals.length; i++) {\n              // if (i < 8) {\n              var predicted = arrivals[i].predictedArrivalTime ? true : false\n              var seconds = arrivals[i].predictedArrivalTime || arrivals[i].scheduledArrivalTime\n              var diff = seconds - moment().valueOf()\n              var routeName = arrivals[i].routeShortName\n              // console.log(diff)\n              // var minutes = String(Math.floor(divisor_for_minutes / 60))\n              var fromNow = Math.floor(diff / 60 / 1000); // moment(seconds).toNow(true)//.replace('minutes', '').replace('a few seconds', '<strong>NOW</strong>').replace('a minute', '<strong>NOW</strong>')\n              var fromNowText = fromNow <= 1 ? '<strong>NOW</strong>' : fromNow\n              var headsign = trimHeadsign(arrivals[i].tripHeadsign)\n              var patt = new RegExp('Airport')\n              if (patt.test(headsign)) {\n                headsign += ' <i class=\"fa fa-plane\"></i>'\n              }\n              // data.push([\n              // \tarrivals[i].routeShortName, \n              // \tfromNow, \n              // \theadsign, \n              // \t+seconds\n              // ])\n              var row = $('<tr class=\"info\">')\n              if (predicted) {\n                fromNowText += ' <i style=\"font-size:0.7em;\" alt=\"Predicted arrival time\" title=\"Predicted arrival time\" class=\"fa fa-bolt\"></i>'\n              }\n              row.append('<td><span class=\"' + labelMap[routeName] + '\">' + routeName + '</span></td>')\n              row.append('<td data-order=\"' + fromNow + '\">' + fromNowText + '</td>')\n              row.append('<td>' + headsign + '</td>')\n              tbody.append(row)\n            // }\n            }\n            table.append(tbody)\n            console.log(data)\n            if ($.fn.dataTable.isDataTable(tableId)) {\n              arrivalsDatatable = table.DataTable()\n              // arrivalsDatatable.clear()\n              // arrivalsDatatable.rows.add(data)\n              // arrivalsDatatable.draw()\n              arrivalsDatatable.destroy()\n            }\n            // else {\n            arrivalsDatatable = table.DataTable({\n              'order': [[ 1, 'asc' ]],\n              // \"columns\": [\n              // \t{\"title\": \"Route\"},\n              // \t{\"title\": \"Minutes\"},\n              // \t{\"title\": \"Direction\"},\n              // \t{\"title\": \"diff\", \"type\": \"num\"}\n              // ],\n              // \"columnDefs\": [\n              // \t// \"targets\": [ 2 ],\n              // \t// \"visible\": false\n              // \t// { \"type\": \"num\", \"targets\": 0 }\n              // \t{ \"visible\": false, \"targets\": 3 },\n              // \t// { \"orderData\": 1,    \"targets\": 3 },\n              // ],\n              // \"data\": data,\n              'paging': false,\n              // \"pageLength\": 6,\n              // \"ordering\": false,\n              'info': false,\n              'bFilter': false\n            })\n          // }\n          } // end if there are arrivals in the list\n          else {\n            table.hide()\n            $('#' + widgetClass + '-stop-name').html('')\n            $('#' + widgetClass + '-last-updated').html('')\n            $('#' + widgetClass + '-arrival-msg').text('No arrivals in the next 30 minutes.')\n            $('#' + widgetClass + '-arrival-msg').show()\n          }\n        }\n      })\n    }\n    if (widgetClass === 'next') {\n      $('#next-carousel').carousel('next')\n    }\n  })\n  $('.plan-control').change(function () {})\n  $('.planner-go-btn').click(function () {\n    var params = {}\n    // var plannerChoice = $('.planner-choice-btn').val()\n    var plannerChoice = $(this).text()\n    var origin = $('#planner-options-from-latlng').val()\n    var destination = $('#planner-options-dest-latlng').val()\n    var time = $('#planner-timepicker').val()\n    if (origin && destination && time) {\n      // Continue with trip plan\n    } else {\n      $('#planner-message')\n        .fadeIn()\n        .html('Please add a valid origin, destination, and time.')\n        .delay(2000)\n        .fadeOut('slow')\n      return\n    }\n    if (/Google/.test(plannerChoice)) {\n      params.saddr = origin\n      params.daddr = destination\n      params.dirflg = 'r'\n      var googUrl = 'http://maps.google.com/?'\n      // window.location.href = googUrl + serialize(params); \n      window.open(googUrl + serialize(params), '_blank')\n    } else {\n      params.fromPlace = origin\n      params.toPlace = destination\n      params.arriveBy = $('.planner-time-btn:first-child').val() === 'Arrive by' ? true : false\n      params.date = moment().format('YYYY-MM-DD')\n      params.time = $('.planner-time-btn:first-child').val() === 'Leave now' ? moment().valueOf() : getTime()\n      params.fromName = $('#planner-options-from').val() // $('#from').select2('data')[0].text\n      // params.toPlace = $('#planner-options-dest-latlng').val()\n      params.toName = $('#planner-options-dest').val() // $('#to').select2('data')[0].text\n      params.mode = 'TRANSIT,WALK'; // $('input[name=mode-select]:checked').val()\n      var atltransitUrl = '/plan#'\n      // console.log(atltransitUrl + serialize(params))\n      window.location.href = atltransitUrl + serialize(params)\n    }\n  // window.location.href='{{ site.baseurl }}/plan' + params\n  })\n  $('.planner-time-menu li a').click(function () {\n    $('.planner-time-btn:first-child').html('<i class=\"fa fa-clock-o right-5\"></i>' + $(this).text() + '<i class=\"fa fa-caret-down left-5\"></i>')\n    $('.planner-time-btn:first-child').val($(this).text())\n    var val = $('.planner-time-btn:first-child').val()\n    if (val === 'Depart at' || val === 'Arrive by') {\n      $('#planner-options-inputgroup-time').show()\n    } else {\n      $('#planner-options-inputgroup-time').hide()\n    }\n  })\n\n  $('.planner-choice-menu li a').click(function () {\n    $('.planner-choice-btn:first-child').html($(this).text())\n    $('.planner-choice-btn:first-child').val($(this).text())\n  })\n  //   $('.box').click(function() {\n\n  //     $(this).animate({\n  //         left: '-50%'\n  //     }, 500, function() {\n  //         $(this).css('left', '150%')\n  //         $(this).appendTo('#box-container')\n  //     })\n\n  //     $(this).next().animate({\n  //         left: '50%'\n  //     }, 500)\n  // })\n  $('#trig').on('click', function () {\n    $('#col1').toggleClass('col-md-12 col-md-3')\n    $('#col2').toggleClass('col-md-0 col-md-9')\n  })\n})\n// }\n","function compareRouteNames (a, b) { return a.shortName - b.shortName; }\nfunction findBootstrapEnvironment () {\n  var envs = ['xs', 'sm', 'md', 'lg']\n\n  $el = $('<div>')\n  $el.appendTo($('body'))\n\n  for (var i = envs.length - 1; i >= 0; i--) {\n    var env = envs[i]\n\n    $el.addClass('hidden-' + env)\n    if ($el.is(':hidden')) {\n      $el.remove()\n      return env\n    }\n  }\n}\n// function setupAutoComplete(inputId){\n//   console.log('setting up autocomplete for ' + inputId)\n//   if (typeof inputId !== 'undefined'){\n//     $( \"#\" + inputId ).autocomplete({\n//           autoFocus: true,\n//           minLength: 0,\n//           //appendTo: \"#planner-options-from-autocompletecontainer\",\n//           messages : Locale.autocompleteMessages,\n//           source: Geocoder.geocoder,\n//           search: function( event, ui ) {\n//               $( \"#\" + inputId + \"-latlng\" ).val( \"\" )\n//           },\n//           focus: function( event, ui ) {\n//               // $( \"#planner-options-from\" ).val( ui.item.label )\n//               //$( \"#planner-options-from-latlng\" ).val( ui.item.latlng )\n//               console.log('focus up toPlace')\n//               return false\n//           },\n//       select: function( event, ui ) {\n//         $( \"#project-description\" ).html( ui.item.desc )\n//         console.log(ui.item)\n//         var point\n//         if (typeof markers['originMarker'] !== 'undefined'){\n//           map.removeLayer(markers['originMarker'])\n//         }\n//         if (/Your location/g.test(ui.item.label)){\n//           console.log('your location selected')\n//           $( \"#\" + inputId ).val( ui.item.desc )\n//           point = ui.item.desc.split(\",\")\n//           if (typeof map !== 'undefined'){\n//             addMarker({lat:Number(point[0]),lng:Number(point[1])}, ui.item.label, \"originMarker\", 'form')\n//           }\n//           $( \"#planner-options-from-latlng\" ).val( ui.item.desc )\n//           return false\n//         }\n//         else{\n//           $( \"#\" + inputId ).val( ui.item.label )\n//           var params = {\n//             text: ui.item.label,\n//             magicKey: ui.item.key,\n//             f: 'pjson'\n//           }\n//           $.ajax(esri_url + 'find', {\n//             data : params,\n//             success: function( data ) {\n//             var json = JSON.parse(data)\n//             console.log(json)\n//             var geometry = json.locations[0].feature.geometry\n//             if (typeof map !== 'undefined'){\n//               addMarker({lat:Number(geometry.y),lng:Number(geometry.x)}, ui.item.label, \"originMarker\", 'form')\n//             }\n//             $( \"#\" + inputId + \"-latlng\" ).val( geometry.y + ',' + geometry.x )\n//             return false\n//                   }\n//                 })\n//               } \n//           }\n\n//       })\n//     .focus(function(){\n//       console.log('focus')\n//       if (typeof lat !== 'undefined'){\n//         $(this).autocomplete('search')\n//       }\n//       console.log(this.id)\n//     })\n//     .data(\"ui-autocomplete\")._renderItem = function (ul, item) {\n//       return $(\"<li></li>\")\n//         .data(\"item.autocomplete\", item)\n//         .append(\"<b>\" + item.label + \"</b><br>\" + item.desc) //+ \"</a>\")\n//         .appendTo(ul)\n//     }\n//   }\n// }\nfunction setupDatetime () {\n  // if(Modernizr.inputtypes.time){\n  $('#planner-options-timeformat').hide()\n  $('#planner-options-timeformat').attr('aria-hidden', true)\n  // }\n  setTime(currentTime)\n  function pad (n) { return n < 10 ? '0' + n : n }\n  var date = currentTime.year() + '-' + pad(currentTime.month() + 1) + '-' + pad(currentTime.date())\n  setDate(date)\n  if (typeof $().datepicker === 'function') {\n    $('#planner-options-date').datepicker({\n      dateFormat: Locale.dateFormat,\n      dayNames: Locale.days,\n      dayNamesMin: Locale.daysMin,\n      monthNames: Locale.months,\n      defaultDate: 0,\n      hideIfNoPrevNext: true,\n      minDate: whitelabel_minDate,\n      maxDate: whitelabel_maxDate\n    })\n  } else {\n    console.log('error no datetimepicker')\n  }\n  /* Read aloud the selected dates */\n  $(document).on('mouseenter', '.ui-state-default', function () {\n    var text = $(this).text() + ' ' + $('.ui-datepicker-month', $(this).parents()).text() + ' ' + $('.ui-datepicker-year', $(this).parents()).text()\n    $('#planner-options-date-messages').text(text)\n  })\n\n  // if(Modernizr.inputtypes.date){\n  $('#planner-options-dateformat').hide()\n  $('#planner-options-dateformat').attr('aria-hidden', true)\n// }\n}\nfunction setDate (iso8601) {\n  parts = iso8601.split('-')\n  var d = moment(iso8601)\n  $('#planner-options-date').val(d.format('MM-DD-YYYY'))\n}\nfunction setTime (iso8601) {\n  // if(Modernizr.inputtypes.time){\n  //     $('#planner-options-time').val(iso8601.slice(0,5))\n  // }else{\n  console.log(iso8601)\n  input = moment(iso8601, 'hh:mm a')\n  // var secs = parseInt(val[0])*60*60+parseInt(val[1])*60\n  // var hours = String(Math.floor(secs / (60 * 60)) % 24)\n  // var divisor_for_minutes = secs % (60 * 60)\n  // var minutes = String(Math.floor(divisor_for_minutes / 60))\n  console.log(input.format('HH:mm'))\n\n  $('#planner-options-time').val(input.format('HH:mm'))\n// }\n}\n\nfunction getDate () {\n  return moment($('#planner-options-date').val(), 'MM-DD-YYYY').format('YYYY-MM-DD')\n}\nfunction getTime () {\n  var time = moment($('#planner-options-time').val(), 'HH:mm')\n  return time.format('hh:mm a')\n}\n// Scrolls to anchor tag from subnav link\nfunction scrollToAnchor (aid) {\n  if (typeof aid !== 'undefined') {\n    console.log(aid)\n    var aTag = $(\"[id='\" + aid + \"']\")\n    console.log(aTag)\n    scrollToOffset(aTag.offset().top)\n  } else {\n    scrollToOffset(0)\n  }\n}\n\nfunction scrollToOffset (offset) {\n  $('html,body').animate({\n    scrollTop: offset // - 60\n  }, 'slow')\n}\n\n$('.toc a').click(function (e) {\n  e.preventDefault()\n\n  var hash = $(this).attr('href').split('#')[1]\n  history.pushState(null, null, '#' + hash)\n  scrollToAnchor($(this).attr('href').split('#')[1])\n})\n\n// Set all thumbnails to same height\nfunction equalHeight (group) {\n  var tallest = 0\n\n  group.each(function () {\n    $(this).css({'height': ''})\n    var thisHeight = $(this).height()\n    console.log(thisHeight)\n    if (thisHeight > tallest) {\n      tallest = thisHeight\n    }\n  })\n  console.log('resizing...' + tallest)\n  group.each(function () { $(this).height(tallest); })\n}\n// Bind the function to global jQuery object.\n$.fn.reveal = function () {\n  // Arguments is a variable which is available within all functions\n  // and returns an object which holds the arguments passed.\n  // It is not really an array, so by calling Array.prototype\n  // he is actually casting it into an array.\n  var args = Array.prototype.slice.call(arguments)\n\n  // For each elements that matches the selector:\n  return this.each(function () {\n    // this is the dom element, so encapsulate the element with jQuery.\n    var img = $(this),\n      src = img.data('src')\n\n    // If there is a data-src attribute, set the attribute\n    // src to make load the image and bind an onload event.\n    src && img.attr('src', src).load(function () {\n      // Call the first argument passed (like fadeIn, slideIn, default is 'show').\n      // This piece is like doing img.fadeIn(1000) but in a more dynamic way.\n      img[args[0] || 'show'].apply(img, args.splice(1))\n    })\n  })\n}\n$(document).ready(function () {\n  // Initialize lazy loading\n  // var layzr = new Layzr({\n  //       callback: function() {\n  //         // equalHeight($(\".equal-height\"))\n  //       }\n  // })\n  // $(\"img\").reveal(\"fadeIn\", 1000)\n  // equalHeight($(\".equal-height\")); \n})\n\n// Check equal-height height on resize\n\nvar waitForFinalEvent = (function () {\n  var timers = {}\n  return function (callback, ms, uniqueId) {\n    if (!uniqueId) {\n      uniqueId = \"Don't call this twice without a uniqueId\"\n    }\n    if (timers[uniqueId]) {\n      clearTimeout(timers[uniqueId])\n    }\n    timers[uniqueId] = setTimeout(callback, ms)\n  }\n})()\n\n$(window).resize(function () {\n  waitForFinalEvent(function () {\n    // equalHeight($(\".equal-height\"))\n    // ...\n  }, 500, 'some unique string')\n})\n\njQuery.unparam = function (value) {\n  if (value.length > 1 && value.charAt(0) == '#') {\n    value = value.substring(1)\n  }\n  var\n    // Object that holds names => values.\n    params = {},\n    // Get query string pieces (separated by &)\n    pieces = value.split('&'),\n    // Temporary variables used in loop.\n    pair, i, l\n\n  // Loop through query string pieces and assign params.\n  for (i = 0, l = pieces.length; i < l; i++) {\n    pair = pieces[i].split('=', 2)\n    // Repeated parameters with the same name are overwritten. Parameters\n    // with no value get set to boolean true.\n    params[decodeURIComponent(pair[0])] = (pair.length == 2 ?\n      decodeURIComponent(pair[1].replace(/\\+/g, ' ')) : true)\n  }\n  console.log(params)\n  return params\n}\n// Extended disable function\njQuery.fn.extend({\n  disable: function (state) {\n    return this.each(function () {\n      var $this = $(this)\n      if ($this.is('input, button, a'))\n        this.disabled = state\n      else\n        $this.toggleClass('disabled', state)\n    })\n  }\n})\nfunction trimHeadsign (headsign) {\n  headsign = headsign.split('-').length > 1 ? headsign.split('-')[1] : headsign\n  headsign = headsign.split('TO').length > 1 ? headsign.split('TO')[1] : headsign\n  headsign = headsign.replace(/STATION/i, '')\n  headsign = toTitleCase(headsign)\n\n  return headsign\n}\nfunction cleanStopName (name) {\n  name = name\n    .replace(/(@)(?!\\s)/g, ' @ ')\n    .replace(/(\\/)(?!\\s)/g, ' / ')\n    .replace(/STATION/g, '')\n  name = toTitleCase(name)\n  return name\n\n}\nfunction getDistanceFromLatLonInKm (lat1, lon1, lat2, lon2) {\n  var R = 6371 // Radius of the earth in km\n  var dLat = deg2rad(lat2 - lat1) // deg2rad below\n  var dLon = deg2rad(lon2 - lon1)\n  var a =\n  Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\n    Math.sin(dLon / 2) * Math.sin(dLon / 2)\n\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))\n  var d = R * c // Distance in km\n  return d\n}\nfunction deg2rad (deg) {\n  return deg * (Math.PI / 180)\n}\nfunction toTitleCase (str) {\n  return str.replace(/\\w\\S*/g, function (txt) {\n    if (/LCI|CTP|TDM|CSX|^NW$|^NE$|^SE$|^SW$|MARTA|GWCC|CNN|^FY$|^ARC$|^SR$|^II$|^STP$|^III$|^US$|CMAQ/g.test(txt))\n      return txt\n    else if (/^IN$|^OF$|^AND$|^FOR$/g.test(txt)) {\n      return txt.toLowerCase()\n    }\n    else\n      return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()\n  })\n}\nserialize = function (obj, prefix) {\n  var str = []\n  for (var p in obj) {\n    if (obj.hasOwnProperty(p)) {\n      var k = prefix ? prefix + '[' + p + ']' : p, v = obj[p]\n      str.push(typeof v == 'object' ?\n        serialize(v, k) :\n        encodeURIComponent(k) + '=' + encodeURIComponent(v))\n    }\n  }\n  return str.join('&')\n}\nvar bs = findBootstrapEnvironment()\nconsole.log(bs)\nif (bs === 'md' || bs === 'sm') {\n  $('.agency-arrivals-radio').addClass('btn-xs')\n}\n","var whitelabel_prefix = 'http://opentrip.atlantaregion.com/otp-rest-servlet/';\n\nvar whitelabel_minDate = new Date(2014, 02, 08);\nvar whitelabel_maxDate = new Date(2020, 03, 30);\n\nvar Locale = {};\n\nLocale.dateFormat = 'mm-dd-yy';\nLocale.timeFormat = 'h:mma';\nLocale.dateAriaLabel = 'Date, use Ctrl en arrow keys to navigate, enter to choose';\nLocale.loading = \"Loading...\";\nLocale.edit = \"Change trip\";\nLocale.plan = \"Plan trip\";\nLocale.geocoderInput = \"Enter starting address...\";\nLocale.originInput = \"Enter starting address...\";\nLocale.destinationInput = \"Enter destination...\";\nLocale.startpointEmpty = \"No starting point entered\";\nLocale.noStartpointSelected = \"No starting point selected\";\nLocale.destinationEmpty = \"No destination entered\";\nLocale.noDestinationSelected = \"No destination selected\";\nLocale.noValidDate = \"Enter a valid date\";\nLocale.noValidTime = \"Enter a valid time\";\nLocale.dateTooEarly = function ( minDate8601 ) { return \"This trip planner works for travel dates starting \"+minDate8601.split('-').reverse().join('-'); };\nLocale.dateTooLate = function ( maxDate8601 ) { return \"This trip planner works for travel dates till \"+maxDate8601.split('-').reverse().join('-'); };\nLocale.from = \"From\";\nLocale.via = \"Via\";\nLocale.to = \"To\";\nLocale.date = \"Date\";\nLocale.time = \"Time\";\nLocale.months = ['January','February','March','April','May','June','July','August','September','October','November','December'];\nLocale.days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];\nLocale.daysMin = ['Su','Mo','Tu','We','Th','Fr','Sa'];\nLocale.earlier = 'Earlier';\nLocale.later = 'Later';\nLocale.noAdviceFound = 'No valid trips found';\nLocale.walk = 'Walk';\nLocale.platformrail = 'Platform';\nLocale.platform = 'Platform';\nLocale.amountTransfers = function ( transfers ) { if (transfers === 0) { return 'Direct'; } else { return transfers+ ' transfers';} };\nLocale.autocompleteMessages = {\n        noResults: \"No results found.\",\n        results: function( amount ) {\n            return amount + ( amount > 1 ? \" results are \" : \" result is\" ) + \" available, use the up and down arrow keys to navigate them.\";\n        }\n};","$('.nav-search').submit(function(e){\n\te.preventDefault();\n\tconsole.log(this.value);\n});\n\n\n\n// For fare table tooltips\n$('[data-toggle=\"tooltip\"]').tooltip();\n\n// Close currently open nav div when another is clicked\n// http://stackoverflow.com/a/23973965/915811\n$(\"[data-collapse-group='navbarCollapse']\").click(function (e) {\n\te.preventDefault();\n    var $this = $(this);\n    console.log(this);\n    $(\"[data-collapse-group='navbarCollapse']:not([data-target='\" + $this.data(\"target\") + \"'])\").each(function () {\n    \t$(this).addClass('collapsed');\n    \tconsole.log(this);\n        $($(this).data(\"target\")).removeClass(\"in\").addClass('collapse');\n\n    });\n});\n\n// Google custom search engine javascript\n// (function() {\n//   var cx = '012656238249604753028:qzpqrvzllsa'; // Insert your own Custom Search engine ID here\n//   var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;\n//   gcse.src = (document.location.protocol == 'https' ? 'https:' : 'http:') +\n//       '//cse.google.com/cse.js?cx=' + cx;\n//   var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);\n// })();\n\n\n// function doneResizing(){$(\".drawer-marker\").toggleClass(\"is-resizing\",!1)}$(\"#gov_form\").submit(function(){var e=(new RegExp(\"/@/\",\"g\"),$(\"#gov_form input\").val());/@/g.test(e)?($(\"#gov_form select option[value=email]\").attr(\"selected\",\"selected\"),$('#gov_form input[type=\"text\"]').attr(\"id\",\"email\").attr(\"name\",\"email\"),$(\"#gov_form label\").attr(\"for\",\"email\")):($(\"#gov_form\").append('<input id=\"country_code\" name=\"country_code\" title=\"Country code\" type=\"hidden\" value=\"1\" />'),$(\"#gov_form select option[value=phone]\").attr(\"selected\",\"selected\"),$('#gov_form input[type=\"text\"]').attr(\"id\",\"phone\").attr(\"name\",\"phone\"),$(\"#gov_form label\").attr(\"for\",\"phone\"))}),$skip=$(\".mast-skip\"),$mastLogo=$(\".mast-logo\"),$menu=$(\".mast-menu\"),$menuControl=$(\".menu-control\"),$menuHeader=$(\".menu-item-header\"),$menuContent=$(\".menu-content\"),$linkHeader=$(\".menu-item-link\"),$drawers=$(\".drawer\"),$drawerHeaders=$(\".drawer-header\"),$drawerContents=$(\".drawer-content\"),$drawerFacade=$(\".drawer-facade\"),$moreDrawer=$(\".drawer-alt > .drawer-content\"),$menuControl.click(function(e){menuControlClick(e)}),$menuHeader.click(function(e){menuHeaderClick(e)}),$linkHeader.click(function(e){linkHeaderClick(e)}),$drawerHeaders.focus(function(e){drawerHeaderFocus(e)}),$drawerHeaders.blur(function(e){drawerHeaderBlur(e)}),$drawerHeaders.click(function(e){drawerHeaderClick(e)}),$skip.click(function(e){onSkip(e)}),this.lastWidth=0,this.lastHeight=0;var height,resizeId;this.isExpanded=!1,$content=$(\"#content\"),$(window).resize(function(e){$(\".drawer-marker\").toggleClass(\"is-resizing\",!0),clearTimeout(resizeId),resize(e),resizeId=setTimeout(doneResizing,500)}),setTimeout(function(){$(window).trigger(\"resize\")},1e3),this.activeDrawer=this.$drawers.eq(0),this.activeContent=this.activeDrawer.find(\".drawer-content\").eq(0),this.activeDrawer.addClass(\"is-active-drawer\"),this.isMobile=$(window).width()<720,this.isLastMobile=this.isMobile,resize=function(e){this.isLastMobile=this.isMobile,this.isMobile=$(window).width()<720,this.isMobile!==this.isLastMobile&&(this.collapseDrawer(),this.setDrawerHeight(0),this.$drawerHeaders.parent().removeClass(\"is-active\").siblings().removeClass(\"is-active\")),!this.isMobile&&this.isExpanded?this.setDrawerHeight(this.activeContent.children().outerHeight(!0)):this.setDrawerHeight(),this.lastWidth=$(window).width()},menuControlClick=function(e){this.isExpanded?(this.collapseDrawer(),this.setDrawerHeight(0)):(this.expandDrawer(),this.setDrawerHeight(100)),setTimeout(function(){$moreDrawer.attr(\"aria-hidden\",!self.isExpanded)},260)},menuHeaderClick=function(e){$(e.currentTarget).parent().toggleClass(\"is-active\").siblings().removeClass(\"is-active\")},onSkip=function(e){e.preventDefault(),$(\"#content\").find(\":focusable\").eq(0).trigger(\"focus\")},linkHeaderClick=function(e){this.collapseDrawer(),this.setDrawerHeight(0)},drawerHeaderClick=function(e){this.isMobile||e.preventDefault(),this.setActiveDrawer($(e.currentTarget))},drawerHeaderFocus=function(e){this.isMobile||e.preventDefault()},drawerHeaderBlur=function(e){this.isMobile||e.preventDefault()},setActiveDrawer=function(e){this.activeDrawer=e.parent(),this.activeContent=e.siblings(\".drawer-content\").eq(0),this.isExpanded&&this.activeDrawer.hasClass(\"is-active-drawer\")?(this.collapseDrawer(),this.setDrawerHeight(0)):(this.expandDrawer(),this.setDrawerHeight(this.activeContent.children().outerHeight(!0))),e.parent().addClass(\"is-active-drawer\").siblings().removeClass(\"is-active-drawer\")},expandDrawer=function(){this.isExpanded=!0,this.activeContent.attr(\"aria-hidden\",\"false\")},collapseDrawer=function(){this.isExpanded=!1,setTimeout(function(){$drawerContents.attr(\"aria-hidden\",\"true\")},250)},setDrawerHeightNarrow=function(e){0!==e&&(e=this.$menuContent.children().eq(0).outerHeight(!0)),this.setContentBuffer(e)},setDrawerHeight=function(e){return void 0===e?e=this.lastHeight:this.lastHeight=e,this.isMobile?void this.setDrawerHeightNarrow(e):void this.setContentBuffer(e)},\n\n// setContentBuffer=function(e){$content.css({transform:[\"translate3d(0\",e+\"px\",\"0)\"].join(\",\")}),$(\"#footer\").css({transform:[\"translate3d(0\",e+\"px\",\"0)\"].join(\",\"),\"margin-bottom\":e})};\n\nshiftContent=function(e){\n\t// $('.content, .footer').animate({ left: '+=300' }, 400);\n\t// $(\".content, .footer\").animate({\n\t//     step: function() {\n\t//         $(this).css('-webkit-transform',\"translate3d(0px, \" + e + \"px, 0px)\");\n\t//     },\n\t//     duration: 1000,\n\t//     easing: 'easeOutQuint'\n\t// });\n\t$('.content').animate({ marginTop: '+='+e+'px' }, 600, 'easeOutQuint');\n};\n\n// $('.dropdown-link').click(function(e){\n// \te.preventDefault();\n// \tvar $this = $(this);\n// \tshiftContent($this.height());\n\n// })\n\n\n// Active nav\n// console.log(atltransit.nav);\n// console.log(atltransit.nav['{{ page.category }}']);\n// $('.nav-sidebar').append('<li><a href=\"/{{ page.category }}\">{{ page.category }}</a></li>');\n// $.each(atltransit.nav['{{ page.category }}'], function(i, item){\n// \tvar activeLabel = '';\n// \tvar activeBar = '';\n// \tif ('{{ page.id }}' === item ){\n// \t\tactiveLabel = '<span class=\"sr-only\">(current)</span>';\n// \t\tactiveBar = 'class=\"active\"';\n// \t}\n// \t$('.nav-sidebar').append('<li ' + activeBar + '><a href=\"/{{ page.category }}/' + item + '\">'+item + activeLabel + '</a></li>');\n// });\n","var routeTypeMap = {\n\t\t'0': 'Tram',\n\t\t'1': 'Subway',\n\t\t'2': 'Rail',\n\t\t'3': 'Bus',\n\t\t'4': 'Ferry',\n\t\t'5': 'Cable',\n\t\t'6': 'Gondola',\n\t\t'7': 'Funicular'\n\t};\nvar currentTime = moment();\nsetupDatetime();\n\n// Schedules agency select change\n\t$('input[type=radio][name=agency-arrivals-option], #schedules-agencies').change(function(){\n\t\t$('#schedules-routes').html('<option value=\"\">[Select Route]</option>');\n\t\t$('#schedules-trips')\n\t\t\t.html('<option value=\"\">[Select Direction]</option>')\n\t\t\t.prop('disabled', true);\n\t\t$('#schedules-stops')\n\t\t\t.html('<option value=\"\">[Select Stop]</option>')\n\t\t\t.trigger('change')\n\t\t\t.prop('disabled', true);\n\t\tconsole.log(this.value);\n\t\tif (this.value === 'Nearby'){\n\t\t\t$('#get-location').trigger('click');\n\t\t\treturn true;\n\t\t}\n\t\tvar agencyId = this.value;\n\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/routes-for-agency/' + agencyId + '.json?';\n\t\tvar params = {};\n\t\t// params.id = agencyId;\n\t\tparams.key = 'TEST';\n\t\turl += serialize(params);\n\t\t$.ajax({\n\t\t\turl: url,\n\t\t\tdataType: 'jsonp',\n\t\t\tsuccess: function(json){\n\t\t\t\tconsole.log(json.data);\n\t\t\t\tvar routeNest = d3.nest()\n\t\t\t\t\t\t.key(function(d) { return d.type; })\n\t\t\t\t\t\t.sortValues(compareRouteNames)\n\t\t\t\t\t\t.map(json.data.list);\n\t\t\t\tconsole.log(routeNest);\n\t\t\t\tvar routes = json.data.list;\n\t\t\t\t$.each(routeNest, function(type, routes) {  \n\t\t\t\t\tvar optgroup = $('<optgroup>');\n\t\t\t\t\toptgroup.attr('label',routeTypeMap[type]);\n\t\t\t\t\t$.each(routes, function(i, route){\n\t\t\t\t\t\tvar option = $(\"<option></option>\");\n\t\t\t\t\t\tvar routeFullText = routeTypeMap[type] === 'Subway' ? route.shortName : route.shortName + ' - ' + route.longName;\n\t\t\t\t\t\tvar routeText = route.longName === '' ? route.shortName : routeFullText;\n\t\t\t\t\t\toption.val(route.id);\n\t\t\t\t\t\toption.text(routeText);\n\t\t\t\t\t\toptgroup.append(option);\n\t\t\t\t\t});\n\t\t\t\t\t$('#schedules-routes').append(optgroup);\n\t\t\t\t});\n\t\t\t\t$('#schedules-routes').prop('disabled', false);\n\t\t\t}\n\t\t}); // end ajax\n\t});\n\t// Use location \n\t$('#get-location').click(function(){\n\t\t$('#schedules-agencies').val('Nearby');\n\t\t$('#schedules-routes').html('<option value=\"\">[Select Route]</option>');\n\t\t$('#schedules-stops')\n\t\t\t.html('<option value=\"\">[Select Stop]</option>')\n\t\t\t.trigger('change')\n\t\t\t.prop('disabled', true);\n\t\t$('#schedules-trips')\n\t\t\t.html('<option value=\"\">[Select Direction]</option>')\n\t\t\t.prop('disabled', true);;\n\t\t$(this).val(moment().unix());\n\t\tif (geolocationBool && typeof lat !== 'undefined'){\n\t\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/routes-for-location.json?';\n\t\t\tvar params = {};\n\t\t\tparams.lat = lat;\n\t\t\tparams.lon = lon;\n\t\t\tparams.radius = 4000;\n\t\t\tparams.key = 'TEST';\n\t\t\turl += serialize(params);\n\t\t\t$.ajax({\n\t\t\t\turl: url,\n\t\t\t\tdataType: 'jsonp',\n\t\t\t\tsuccess: function(json){\n\t\t\t\t\tconsole.log(json.data);\n\t\t\t\t\tvar routeNest = d3.nest()\n\t\t\t\t\t\t.key(function(d) { return d.agencyId; })\n\t\t\t\t\t\t.map(json.data.list);\n\t\t\t\t\tconsole.log(routeNest);\n\t\t\t\t\tvar agencyCount = 0;\n\t\t\t\t\tvar firstValue;\n\t\t\t\t\t$.each(routeNest, function(agency, routes) {  \n\t\t\t\t\t\tvar optgroup = $('<optgroup>');\n\t\t\t\t\t\toptgroup.attr('label',agency);\n\t\t\t\t\t\t$.each(routes, function(i, route){\n\t\t\t\t\t\t\tvar option = $(\"<option></option>\");\n\t\t\t\t\t\t\tif (agencyCount === 0 || i === 0){\n\t\t\t\t\t\t\t\tfirstValue = route.id;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar routeFullText = routeTypeMap[route.type] === 'Subway' ? route.shortName : route.shortName + ' - ' + route.longName;\n\t\t\t\t\t\t\tvar routeText = route.longName === '' ? route.shortName : routeFullText;\n\t\t\t\t\t\t\toption.val(route.id);\n\t\t\t\t\t\t\toption.text(routeText);\n\t\t\t\t\t\t\toptgroup.append(option);\n\t\t\t\t\t\t});\n\t\t\t\t\t    $('#schedules-routes').append(optgroup);\n\t\t\t\t\t    agencyCount++;\n\t\t\t\t\t});\n\t\t\t\t\t// $('#schedules-routes').val(firstValue);\n\t\t\t\t\t$('#schedules-routes').prop('disabled', false);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse{\n\t\t\tconsole.log('no geolocation available');\n\t\t}\n\t});\n\t// Select route change\n\t$('#schedules-routes').change(function(){\n\t\tvar widgetClass;\n\t\tif ($(this).hasClass('nearby')){\n\t\t\twidgetClass = 'nearby';\n\t\t}\n\t\telse{\n\t\t\twidgetClass = 'next';\n\t\t}\n\t\twidgetClass = 'schedules';\n\t\t$('#schedules-stops')\n\t\t\t.html('<option value=\"\">[Select Stop]</option>')\n\t\t\t.trigger('change')\n\t\t\t.prop('disabled', true);\n\t\t$('#schedules-trips').html('<option value=\"\">[Select Direction]</option>');\n\t\tconsole.log(this.value);\n\t\tvar routeId = this.value;\n\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/stops-for-route/' + routeId + '.json?';\n\t\tvar params = {};\n\t\tparams.key = 'TEST';\n\t\tparams.includePolylines = false;\n\t\turl += serialize(params);\n\t\t$.ajax({\n\t\t\turl: url,\n\t\t\tdataType: 'jsonp',\n\t\t\tsuccess: function(json){\n\t\t\t\tvar closestDistance = 10000000000;\n\t\t\t\tvar closestStop = '';\n\t\t\t\tvar selectedTrip;\n\t\t\t\tvar stopGroups = json.data.entry.stopGroupings[0].stopGroups;\n\t\t\t\tconsole.log(json.data.entry.stopGroupings[0].stopGroups);\n\t\t\t\tconsole.log(json.data);\n\t\t\t\tvar stopMap = d3.nest()\n\t\t\t\t\t.key(function(d) { return d.id; })\n\t\t\t\t\t.map(json.data.references.stops);\n\t\t\t\tvar tripMap = d3.nest()\n\t\t\t\t\t// .key(function(d) { return d.name.name; })\n\t\t\t\t\t// .key(function(d) { return d.tripHeadsign; })\n\t\t\t\t\t.key(function(d) { return d.id; })\n\t\t\t\t\t.map(stopGroups);\n\t\t\t\tconsole.log(stopMap);\n\t\t\t\tconsole.log(tripMap);\n\t\t\t\tconsole.log(routeId);\n\t\t\t\tconsole.log(tripMap[routeId]);\n\t\t\t\tvar headsigns = [];\n\t\t\t\tvar tripCounter = 0;\n\t\t\t\t$.each(stopGroups, function(i, trip){\n\t\t\t\t\t// var tripId = trip.tripId;\n\t\t\t\t\t// console.log(trip);\n\t\t\t\t\t\n\t\t\t\t\t// if (typeof tripMap[routeId][tripId] !== 'undefined' && tripMap[routeId][tripId][0].routeId === routeId && headsigns.indexOf(tripMap[routeId][tripId][0].tripHeadsign) === -1){\n\t\t\t\t\t\t// var headsign = tripMap[routeId][tripId][0].tripHeadsign;\n\t\t\t\t\t\t// headsigns.push(headsign);\n\t\t\t\t\t\tvar tripLabel = trip.name.name === '' ? trip.id : trimHeadsign(trip.name.name);\n\t\t\t\t\t\ttripLabel = +tripLabel === 1 ? 'Inbound' : tripLabel;\n\t\t\t\t\t\ttripLabel = +tripLabel === 0 ? 'Outbound' : tripLabel;\n\t\t\t\t\t\tvar tripOption = $(\"<option></option>\");\n\t\t\t\t\t\ttripOption.val(trip.id);\n\t\t\t\t\t\ttripOption.text(tripLabel);\n\t\t\t\t\t\t$('#schedules-trips').append(tripOption);\n\t\t\t\t\t\tvar optgroup = $('<optgroup>');\n\t\t\t\t\t\toptgroup.attr('id', trip.id);\n\t\t\t\t\t\toptgroup.attr('label',tripLabel);\n\t\t\t\t\t\tif (tripCounter === 0){\n\t\t\t\t\t\t\tselectedTrip = trip.id;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\toptgroup.addClass('hidden-optgroup');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t$.each(trip.stopIds, function(j, stopId){\n\t\t\t\t\t\t\tvar stop = stopMap[stopId][0];\n\t\t\t\t\t\t\tconsole.log(stop)\n\t\t\t\t\t\t\tvar distance = getDistanceFromLatLonInKm(stop.lat, stop.lon, lat, lon);\n\t\t\t\t\t\t\tif (tripCounter === 0){\n\t\t\t\t\t\t\t\tif (distance < closestDistance){\n\t\t\t\t\t\t\t\t\tclosestDistance = distance;\n\t\t\t\t\t\t\t\t\tclosestStop = stop.id;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar option = $(\"<option></option>\");\n\t\t\t\t\t\t\toption.val(stop.id);\n\t\t\t\t\t\t\toption.attr('distance', distance);\n\t\t\t\t\t\t\tvar stopName = cleanStopName(stop.name);\n\t\t\t\t\t\t\tvar stopDir = stop.direction !== '' ? '(' + stop.direction + ') ' : '';\n\t\t\t\t\t\t\toption.text(stopDir + stopName);\n\t\t\t\t\t\t\toptgroup.append(option);\n\t\t\t\t\t\t\t// $('#' + widgetClass + '-arrivals-stops').append(option);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\t$('#schedules-stops').append(optgroup);\n\t\t\t\t\t\ttripCounter++;\n\t\t\t\t\t// } // end if valid trip for route\n\n\t\t\t\t}); // end each trip\n\t\t\t\tvar $stops = $('#schedules-stops');\n\t\t\t\t$('#schedules-trips').prop('disabled', false);\n\t\t\t\t$('#schedules-trips').val(selectedTrip);\n\t\t\t\t$stops.prop('disabled', false);\n\t\t\t\t$stops.val(closestStop);\n\t\t\t\tif ($stops.val() !== ''){\n\t\t\t\t\t$stops.trigger('change');\n\t\t\t\t}\n\t\t\t\tif ($('#schedules-stops').val() !== ''){\n\t\t\t\t\t$('#schedules-btn').prop('disabled', false);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t$('#schedules-btn').prop('disabled', true);\n\t\t\t\t}\n\t\t\t} // end success\n\t\t}); // end ajax\n\t});\n\tvar previousTrip;\n\t$('#schedules-trips')\n\t\t.on('focus', function () {\n\t\t\t// Store the current value on focus and on change\n\t\t\tpreviousTrip = this.value;\n\t    }).change(function(){\n\t    \tvar closestDistance = 10000000000;\n\t\t\tvar closestStop = '';\n\t\t\tconsole.log(this.value);\n\t\t\t$('#' + previousTrip).addClass('hidden-optgroup');\n\t\t\t$('#' + this.value).removeClass('hidden-optgroup');\n\t\t\t$('#' + this.value + ' > option').each(function(){\n\t\t\t\tvar distance = $(this).attr('distance');\n\t\t\t\tconsole.log(distance);\n\t\t\t\tif (distance < closestDistance){\n\t\t\t\t\tclosestDistance = distance;\n\t\t\t\t\tclosestStop = this.value;\n\t\t\t\t}\n\t\t\t});\n\t\t\tconsole.log(closestStop);\n\t\t\tvar $stops = $('#schedules-stops');\n\t\t\t$stops.val(closestStop);\n\t\t\tif ($stops.val() !== ''){\n\t\t\t\t$stops.trigger('change');\n\t\t\t}\n\t\t});\n\t$('#schedules-stops').change(function(){\n\t\tif (this.value !== ''){\n\t\t\t$('#schedules-btn')\n\t\t\t\t.removeClass('disabled')\n\t\t\t\t.removeAttr('disabled')\n\t\t\t\t.val(this.value);\n\t\t\t$('.get-realtime').removeClass('disabled');\n\t\t}\n\t\telse {\n\t\t\t$('#schedules-btn')\n\t\t\t\t.addClass('disabled')\n\t\t\t\t.attr('disabled', 'disabled')\n\t\t\t\t.val('');\n\t\t\t$('.get-realtime').addClass('disabled');\n\t\t}\n\t});\n\t$('.get-schedules').click(function(){\n\t\tvar widgetClass, stopId;\n\t\t\n\t\tif ($(this).hasClass('stop-code')){\n\t\t\twidgetClass = 'stop-code';\n\t\t}\n\t\telse{\n\t\t\twidgetClass = 'next';\n\t\t}\n\t\twidgetClass = 'schedules';\n\t\tstopId = $('#' + widgetClass + '-btn').val();\n\t\tvar routeId = $('#' + widgetClass + '-routes').val();\n\t\tconsole.log(stopId);\n\t\tconsole.log(routeId);\n\t\tconsole.log(widgetClass);\n\t\tif (stopId !== ''){\n\t\t\t// console.log('stop coding it up');\n\t\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/schedule-for-stop/' + stopId + '.json?';\n\t\t\tvar params = {};\n\t\t\tparams.key = 'TEST';\n\t\t\tparams.minutesBefore = 1;\n\t\t\turl += serialize(params);\n\t\t\t$.ajax({\n\t\t\t\turl: url,\n\t\t\t\tdataType: 'jsonp',\n\t\t\t\tsuccess: function(json){\n\t\t\t\t\tvar routes = json.data.entry.stopRouteSchedules;\n\t\t\t\t\tconsole.log(json.data);\n\t\t\t\t\tvar stopMap = d3.nest()\n\t\t\t\t\t\t.key(function(d) { return d.id; })\n\t\t\t\t\t\t.map(json.data.references.stops);\n\t\t\t\t\tvar routeMap = d3.nest()\n\t\t\t\t\t\t.key(function(d) { return d.id; })\n\t\t\t\t\t\t.map(json.data.references.routes);\n\t\t\t\t\tconsole.log(routeMap);\n\t\t\t\t\tconsole.log(json.data.entry.stopRouteSchedules);\n\t\t\t\t\tif (routes.length > 0){\n\t\t\t\t\t\tstopName = stopMap[json.data.entry.stopId][0].name;\n\t\t\t\t\t\t$('#' + widgetClass + '-stop-code').html(cleanStopName('Stop ID: ' + stopId.split('_')[1]));\n\t\t\t\t\t\t$('#' + widgetClass + '-stop-name').html(cleanStopName(stopName));\n\t\t\t\t\t\t// $('#' + widgetClass + '-last-updated').html('<a class=\"get-arrivals next btn\"><span class=\"glyphicon glyphicon-refresh\" aria-hidden=\"true\"></span> ' + moment(arrivals[0].lastUpdateTime).format('h:mm a') + '</a>');\n\t\t\t\t\t\t$('#nearby-arrival-msg').hide();\n\t\t\t\t\t\tvar data = [];\n\t\t\t\t\t\tvar schedulesDiv = $('.schedules-tables');\n\t\t\t\t\t\tvar rowDiv = $('<div class=\"row\"></div>');\n\t\t\t\t\t\tvar rowDiv2 = $('<div class=\"row\"></div>');\n\t\t\t\t\t\tschedulesDiv.empty();\n\t\t\t\t\t\tfor (var i = 0; i < routes.length; i++) {\n\t\t\t\t\t\t\tconsole.log(routes[i]);\n\t\t\t\t\t\t\tvar routeName = routeMap[routes[i].routeId][0].shortName;\n\t\t\t\t\t\t\tvar directions = routes[i].stopRouteDirectionSchedules;\n\t\t\t\t\t\t\tfor (var j = 0; j < directions.length; j++) {\n\t\t\t\t\t\t\t\tvar numTrips = directions.length * routes.length;\n\t\t\t\t\t\t\t\tvar gridWidth = numTrips > 4 ? 3 : 12 / numTrips;\n\t\t\t\t\t\t\t\tgridWidth = numTrips === 1 ? 6 : gridWidth;\n\t\t\t\t\t\t\t\tgridWidth = 6; // modified gridWidth for narrow layout\n\t\t\t\t\t\t\t\tvar gridWidthSm = numTrips > 4 ? 6 : 12 / numTrips * 2;\n\t\t\t\t\t\t\t\t// var tableId = '#' + widgetClass + '-table';\n\t\t\t\t\t\t\t\tvar columnDiv = $('<div class=\"schedule-table table-responsive col-xs-12 col-md-'+gridWidth+' col-sm-6\"></div>')\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar table = $('<table class=\"table table-striped table-condensed table-hover col-md-'+gridWidth+'\" id=\"schedule-'+routeId+j+'\"></table>');\n\n\t\t\t\t\t\t\t\ttable.append('<thead><tr><th class=\"text-right\">Hour</th><th>Minute</th></tr></thead>');\n\t\t\t\t\t\t\t\tvar tbody = $('<tbody>');\n\t\t\t\t\t\t\t\tvar headsign = trimHeadsign(directions[j].tripHeadsign);\n\t\t\t\t\t\t\t\tif (directions[j].scheduleFrequencies.length > 0){\n\t\t\t\t\t\t\t\t\tconsole.log('freq based');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tconsole.log('sched based');\n\t\t\t\t\t\t\t\t\tconsole.log(directions[j].scheduleStopTimes);\n\t\t\t\t\t\t\t\t\tvar stopTimes = directions[j].scheduleStopTimes;\n\t\t\t\t\t\t\t\t\tvar firstTime = moment(stopTimes[0].arrivalTime);\n\t\t\t\t\t\t\t\t\tvar currentHour = 0;\n\t\t\t\t\t\t\t\t\tvar row;\n\t\t\t\t\t\t\t\t\tvar minuteCell;\n\t\t\t\t\t\t\t\t\tvar morning = firstTime.hour() < 12 ? true : false;\n\t\t\t\t\t\t\t\t\tfor (var k = 0; k < stopTimes.length; k++) {\n\t\t\t\t\t\t\t\t\t\tvar meridian = '';\n\t\t\t\t\t\t\t\t\t\tif (morning && k === 0){\n\t\t\t\t\t\t\t\t\t\t\t// tbody.append('<tr class=\"text-left warning\"><td colspan=\"2\"><strong>AM</strong></td></tr>');\n\t\t\t\t\t\t\t\t\t\t\tmeridian = '<strong>AM</strong>  ';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tvar seconds = stopTimes[k].arrivalTime;\n\t\t\t\t\t\t\t\t\t\t// console.log(seconds);\n\t\t\t\t\t\t\t\t\t\tvar arrivalTime = moment(seconds);\n\t\t\t\t\t\t\t\t\t\tvar arrivalTimeMinutes = arrivalTime.minutes() < 10 ? '0' + arrivalTime.minutes() : arrivalTime.minutes();\n\t\t\t\t\t\t\t\t\t\tvar nextArrivalTime;\n\t\t\t\t\t\t\t\t\t\tif (k !== stopTimes.length - 1){\n\t\t\t\t\t\t\t\t\t\t\tnextArrivalTime = moment(stopTimes[k + 1].arrivalTime);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t// console.log(arrivalTime.format('h:mm a'));\n\t\t\t\t\t\t\t\t\t\tif (arrivalTime.hour() !== currentHour){\n\t\t\t\t\t\t\t\t\t\t\t// console.log(arrivalTime.hour())\n\t\t\t\t\t\t\t\t\t\t\t// console.log(currentHour)\n\t\t\t\t\t\t\t\t\t\t\t// if (arrivalTime.hour() > firstTime.hour()){\n\t\t\t\t\t\t\t\t\t\t\t// \ttbody.append($('.' +i+j+arrivalTime.hour()));\n\t\t\t\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t\t\t\trow = $('<tr id=\"'+i+j+arrivalTime.hour()+'\">');\n\t\t\t\t\t\t\t\t\t\t\tif (arrivalTime.hour() >= 12 && morning){\n\t\t\t\t\t\t\t\t\t\t\t\tmorning = false;\n\t\t\t\t\t\t\t\t\t\t\t\ttbody.append('<tr class=\"blank_row\"><td colspan=\"2\"></td></tr>');\n\t\t\t\t\t\t\t\t\t\t\t\tmeridian = '<strong>PM</strong>  ';\n\t\t\t\t\t\t\t\t\t\t\t\t// tbody.append('<tr class=\"text-left info\"><td colspan=\"2\"><strong>PM</strong></td></tr>');\n\t\t\t\t\t\t\t\t\t\t\t\t// row.append('<td>PM</td>');\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\trow.append('<td class=\"text-right\"><strong>' + meridian + arrivalTime.format('h') + ':</strong></td>');\n\t\t\t\t\t\t\t\t\t\t\tminuteCell = $('<td class=\"text-left\">' + arrivalTimeMinutes + '</td>');\n\t\t\t\t\t\t\t\t\t\t\trow.append();\n\t\t\t\t\t\t\t\t\t\t\tcurrentHour = arrivalTime.hour();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\tminuteCell.append(' ' + arrivalTimeMinutes);\n\t\t\t\t\t\t\t\t\t\t\t// console.log($('.'+i+j+'-hour-'+arrivalTime.hour()).html());\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif (nextArrivalTime.hour() !== arrivalTime.hour()){\n\t\t\t\t\t\t\t\t\t\t\trow.append(minuteCell);\n\t\t\t\t\t\t\t\t\t\t\ttbody.append(row);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif (k == stopTimes.length - 1){\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('done')\n\t\t\t\t\t\t\t\t\t\t\ttable.append(tbody);\n\t\t\t\t\t\t\t\t\t\t\t// console.log(table);\n\t\t\t\t\t\t\t\t\t\t\tcolumnDiv\n\t\t\t\t\t\t\t\t\t\t\t\t.append('<h4><span class=\"'+labelMap[routeName]+'\">' + routeName + '</span> - ' + headsign +'</h4')\n\t\t\t\t\t\t\t\t\t\t\t\t.append(table);\n\t\t\t\t\t\t\t\t\t\t\tif ( i > 1 ){\n\t\t\t\t\t\t\t\t\t\t\t\trowDiv2\n\t\t\t\t\t\t\t\t\t\t\t\t\t.append(columnDiv);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\t\t\t\trowDiv\n\t\t\t\t\t\t\t\t\t\t\t\t\t.append(columnDiv);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tschedulesDiv\n\t\t\t\t\t\t\t\t\t\t\t\t.append(rowDiv)\n\t\t\t\t\t\t\t\t\t\t\t\t.append(rowDiv2);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// var predicted = routes[i].predictedArrivalTime ? true : false;\n\t\t\t\t\t\t\t// var seconds = routes[i].predictedArrivalTime || routes[i].scheduledArrivalTime;\n\t\t\t\t\t\t\t// var diff = seconds - moment().valueOf();\n\t\t\t\t\t\t\t// var routeName = routes[i].routeShortName;\n\t\t\t\t\t\t\t// var fromNow = Math.floor(diff/60/1000);//moment(seconds).toNow(true)//.replace('minutes', '').replace('a few seconds', '<strong>NOW</strong>').replace('a minute', '<strong>NOW</strong>');\n\t\t\t\t\t\t\t// var fromNowText = fromNow <= 1 ? '<strong>NOW</strong>' : fromNow;\n\t\t\t\t\t\t\t// var headsign = trimHeadsign(routes[i].tripHeadsign);\n\t\t\t\t\t\t\t// var patt = new RegExp(\"Airport\");\n\t\t\t\t\t\t\t// if (patt.test(headsign)){\n\t\t\t\t\t\t\t// \theadsign += ' <i class=\"fa fa-plane\"></i>';\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t// var row = $('<tr class=\"info\">');\n\t\t\t\t\t\t\t// if (predicted){\n\t\t\t\t\t\t\t// \tfromNowText += ' <i style=\"font-size:0.7em;\" alt=\"Predicted arrival time\" title=\"Predicted arrival time\" class=\"fa fa-bolt\"></i>';\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t// row.append('<td><span class=\"'+labelMap[routeName]+'\">' + routeName + '</span></td>');\n\t\t\t\t\t\t\t// row.append('<td data-order=\"'+fromNow+'\">' + fromNowText + '</td>');\n\t\t\t\t\t\t\t// row.append('<td>' + headsign + '</td>');\n\t\t\t\t\t\t\t// tbody.append(row);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tconsole.log(data);\n\t\t\t\t\t\t// if ( $.fn.dataTable.isDataTable(tableId) ) {\n\t\t\t\t\t\t// \tarrivalsDatatable = table.DataTable();\n\t\t\t\t\t\t// \t// arrivalsDatatable.clear();\n\t\t\t\t\t\t// \t// arrivalsDatatable.rows.add(data);\n\t\t\t\t\t\t// \t// arrivalsDatatable.draw();\n\t\t\t\t\t\t// \tarrivalsDatatable.destroy();\n\t\t\t\t\t\t// }\n\t\t\t\t\t\t// else {\n\t\t\t\t\t\t\t// arrivalsDatatable = table.DataTable( {\n\t\t\t\t\t\t\t// \t\"order\": [[ 1, \"asc\" ]],\n\t\t\t\t\t\t\t// \t// \"columns\": [\n\t\t\t\t\t\t\t// \t// \t{\"title\": \"Route\"},\n\t\t\t\t\t\t\t// \t// \t{\"title\": \"Minutes\"},\n\t\t\t\t\t\t\t// \t// \t{\"title\": \"Direction\"},\n\t\t\t\t\t\t\t// \t// \t{\"title\": \"diff\", \"type\": \"num\"}\n\t\t\t\t\t\t\t// \t// ],\n\t\t\t\t\t\t\t// \t// \"columnDefs\": [\n\t\t\t\t\t\t\t// \t// \t// \"targets\": [ 2 ],\n\t\t\t\t\t\t\t// \t// \t// \"visible\": false\n\t\t\t\t\t\t\t// \t// \t// { \"type\": \"num\", \"targets\": 0 }\n\t\t\t\t\t\t\t// \t// \t{ \"visible\": false, \"targets\": 3 },\n\t\t\t\t\t\t\t// \t// \t// { \"orderData\": 1,    \"targets\": 3 },\n\t\t\t\t\t\t\t// \t// ],\n\t\t\t\t\t\t\t// \t// \"data\": data,\n\t\t\t\t\t\t\t// \t\"paging\": false,\n\t\t\t\t\t\t\t// \t// \"pageLength\": 6,\n\t\t\t\t\t\t\t// \t// \"ordering\": false,\n\t\t\t\t\t\t\t// \t\"info\": false,\n\t\t\t\t\t\t\t// \t\"bFilter\": false\n\t\t\t\t\t\t\t// });\n\t\t\t\t\t\t// }\n\t\t\t\t\t} // end if there are arrivals in the list\n\t\t\t\t\t// else{\n\t\t\t\t\t// \ttable.hide();\n\t\t\t\t\t// \t$('#' + widgetClass + '-stop-name').html('');\n\t\t\t\t\t// \t$('#' + widgetClass + '-last-updated').html('');\n\t\t\t\t\t// \t$('#' + widgetClass + '-arrival-msg').text('No arrivals in the next 30 minutes.');\n\t\t\t\t\t// \t$('#' + widgetClass + '-arrival-msg').show();\n\t\t\t\t\t// }\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t$('#schedules-carousel').carousel('next');\n\t});"],"sourceRoot":"/source/"}