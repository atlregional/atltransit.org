{"version":3,"sources":["planner-widget.js","utilities.js","locale.js","nav.js","schedules-widget.js"],"names":["getEsriGeometry","option","id","$","ajax","url","esriUrl","dataType","data","text","magicKey","f","success","console","log","geom","locations","feature","geometry","val","y","x","formatRepo","repo","loading","markup","description","formatRepoSelection","compareRouteNames","a","b","shortName","findBootstrapEnvironment","envs","$el","appendTo","i","length","env","addClass","is","remove","setupDatetime","pad","n","hide","attr","setTime","currentTime","date","year","month","setDate","datepicker","dateFormat","Locale","dayNames","days","dayNamesMin","daysMin","monthNames","months","defaultDate","hideIfNoPrevNext","minDate","whitelabel_minDate","maxDate","whitelabel_maxDate","document","on","this","parents","iso8601","parts","split","d","moment","format","input","getDate","getTime","time","scrollToAnchor","aid","aTag","scrollToOffset","offset","top","animate","scrollTop","equalHeight","group","tallest","each","css","height","thisHeight","trimHeadsign","headsign","replace","toTitleCase","cleanStopName","name","getDistanceFromLatLonInKm","lat1","lon1","lat2","lon2","R","dLat","deg2rad","dLon","Math","sin","cos","c","atan2","sqrt","deg","PI","str","txt","test","toLowerCase","charAt","toUpperCase","substr","whitelabel_prefix","Date","timeFormat","dateAriaLabel","edit","plan","geocoderInput","originInput","destinationInput","startpointEmpty","noStartpointSelected","destinationEmpty","noDestinationSelected","noValidDate","noValidTime","dateTooEarly","minDate8601","reverse","join","dateTooLate","maxDate8601","from","via","to","earlier","later","noAdviceFound","walk","platformrail","platform","amountTransfers","transfers","autocompleteMessages","noResults","results","amount","submit","e","preventDefault","value","tooltip","click","$this","removeClass","shiftContent","marginTop","geolocationBool","lat","lon","labelMap","RED","BLUE","GOLD","GREEN","MARTA","CCT","GCT","GRTA","timepicker","carousel","interval","urlParams","dropdown","setupAutoComplete","jQuery","unparam","window","location","hash","tab","trigger","stopId","setTimeout","change","select2","allowClear","delay","term","page","distance","searchExtents","res","suggestions","array","item","arrItem","push","cache","minimumInputLength","templateResult","templateSelection","routeTypeMap","0","1","2","3","4","5","6","7","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","error","code","PERMISSION_DENIED","params","key","serialize","json","list","agencies","agency","agencyId","removeAttr","widgetClass","hasClass","index","html","prop","routeNest","d3","nest","type","sortValues","map","routes","optgroup","route","routeFullText","longName","routeText","append","unix","radius","firstValue","agencyCount","routeId","includePolylines","selectedTrip","closestDistance","closestStop","stopGroups","entry","stopGroupings","stopMap","references","stops","tripMap","tripCounter","trip","tripLabel","tripOption","stopIds","j","stop","stopName","stopDir","direction","$stops","previousTrip","tableId","table","stopCode","query","show","minutesBefore","arrivals","arrivalsAndDepartures","lastUpdateTime","empty","tbody","predicted","predictedArrivalTime","seconds","scheduledArrivalTime","diff","valueOf","routeName","routeShortName","fromNow","floor","fromNowText","tripHeadsign","patt","RegExp","row","fn","dataTable","isDataTable","arrivalsDatatable","DataTable","destroy","order","paging","info","bFilter","plannerChoice","origin","destination","fadeIn","fadeOut","saddr","daddr","dirflg","googUrl","open","fromPlace","toPlace","arriveBy","fromName","toName","mode","atltransitUrl","href","toggleClass","stopRouteSchedules","routeMap","schedulesDiv","rowDiv","rowDiv2","directions","stopRouteDirectionSchedules","numTrips","gridWidth","columnDiv","scheduleFrequencies","scheduleStopTimes","minuteCell","stopTimes","firstTime","arrivalTime","currentHour","morning","hour","k","meridian","nextArrivalTime","arrivalTimeMinutes","minutes","history","pushState","reveal","args","Array","prototype","slice","call","arguments","img","src","load","apply","splice","ready","waitForFinalEvent","timers","callback","ms","uniqueId","clearTimeout","resize","substring","pair","l","pieces","decodeURIComponent","extend","disable","state","disabled","obj","prefix","p","hasOwnProperty","v","encodeURIComponent","bs"],"mappings":"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","file":"atltransit.js","sourcesContent":["var geolocationBool = false;\nvar lat, lon;\nvar labelMap = {\n\t'RED': 'label label-danger',\n\t'BLUE': 'label label-primary',\n\t'GOLD': 'label label-warning',\n\t'GREEN': 'label label-success',\n\t'MARTA': 'label label-orange',\n\t'CCT': 'label label-magenta',\n\t'GCT': 'label label-maroon',\n\t'GRTA': 'label label-cyan',\n};\n\n// window.onload = function(){\n\t// Planner Widget Javascript\n\t$('#planner-timepicker').timepicker();\n\t$('#test-carousel, #next-carousel, #schedules-carousel').carousel({\n\t\t\tinterval: false\n\t});\n\t$('#next-arrivals-agencies').val('');\n\n\t// var Locale = {};\n\t// Locale.autocompleteMessages = {\n\t//         noResults: \"No results found.\",\n\t//         results: function( amount ) {\n\t//             return amount + ( amount > 1 ? \" results are \" : \" result is\" ) + \" available, use the up and down arrow keys to navigate them.\";\n\t//         }\n\t// };\n\t\n\tvar esriUrl = 'https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/';\n\tfunction getEsriGeometry(option, id){\n\t\t$.ajax({\n\t\t\turl: esriUrl + 'find?',\n\t\t\tdataType: 'jsonp',\n\t\t\t// delay: 250,\n\t\t\tdata: {\n\t\t\t    text: option.text, // search term\n\t\t\t    magicKey: option.id,\n\t\t\t    // outFields: 'City,Region',\n\t\t\t    f: 'pjson',\n\t\t\t    // distance: 20000,\n\t\t\t    // searchExtents: -'85.386,34.618,-83.269,32.844',\n\t\t\t    // location: '-84.383149,33.750855',\n\t\t\t},\n\t\t\tsuccess: function(data){\n\t\t\t\tconsole.log(data);\n\t\t\t\tvar geom = data.locations[0].feature.geometry;\n\t\t\t\t$('.planner-form input[name='+id+'Place]').val(geom.y + ',' + geom.x);\n\t\t\t}\n\t\t});\n\t}\n\tfunction formatRepo (repo) {\n\t\tif (repo.loading) return repo.text;\n\n\t\tvar markup = '<div class=\"clearfix\">' +\n\t\t'<div class=\"col-sm-1\">' +\n\t\t// '<img src=\"' + repo.owner.avatar_url + '\" style=\"max-width: 100%\" />' +\n\t\t'</div>' +\n\t\t'<div clas=\"col-sm-10\">' +\n\t\t'<div class=\"clearfix\">' +\n\t\t'<div class=\"col-sm-6\">' + repo.text + '</div>' +\n\t\t// '<div class=\"col-sm-3\"><i class=\"fa fa-code-fork\"></i> ' + repo.forks_count + '</div>' +\n\t\t// '<div class=\"col-sm-2\"><i class=\"fa fa-star\"></i> ' + repo.stargazers_count + '</div>' +\n\t\t'</div>';\n\n\t\tif (repo.description) {\n\t\tmarkup += '<div>' + repo.description + '</div>';\n\t\t}\n\n\t\tmarkup += '</div></div>';\n\n\t\treturn markup;\n\t}\n\n\tfunction formatRepoSelection (repo) {\n\t\treturn repo.text;\n\t}\n\tvar urlParams;\n\t$(function(){\n\t\t$('.dropdown-toggle').dropdown();\n\n\t\t// // load stop ids\n\t\t// var url = 'http://atlanta.onebusaway.org/api/api/where/stop-ids-for-agency/MARTA.json?';\n\t\t// var params = {};\n\t\t// // params.query = stopCode;\n\t\t// params.key = 'TEST';\n\t\t// url += serialize(params);\n\t\t// $.ajax({\n\t\t// \turl: url,\n\t\t// \tdataType: 'jsonp',\n\t\t// \tsuccess: function(json){\n\t\t// \t\tconsole.log(json.data);\n\t\t// \t\tif (json.data.list.length > 0){\n\t\t// \t\t\tstopId = json.data.list[0].id;\n\n\t\t// \t\t}\n\t\t// \t}\n\t\t// });\n\tif (typeof setupAutoComplete === 'function'){\n\t\tsetupAutoComplete();\n\t}\n\n\t\turlParams = jQuery.unparam(window.location.hash);\n\t\t// console.log(params);{}\n\t\tif (typeof urlParams.tab !== 'undefined'){\n\t\t\t$('#' + urlParams.tab + '-link').trigger('click');\n\t\t\tif (typeof urlParams.stopId !== 'undefined'){\n\t\t\t\twindow.setTimeout(function(){\n\t\t\t\t$('#' + urlParams.tab + '-arrivals-btn')\n\t\t\t\t\t.removeClass('disabled')\n\t\t\t\t\t.val(urlParams.stopId)\n\t\t\t\t\t.trigger('click');\n\t\t\t\t}, 200);\n\t\t\t\t\n\t\t\t\t// $(' .stop-code').trigger('click');\n\t\t\t}\n\t\t}\n\t\t$(\".js-data-example-ajax\").change(function(){\n\t\t\tconsole.log(this.value);\n\t\t\tconsole.log($(this).select2('data'));\n\t\t\tvar data = $(this).select2('data') // $(this).select2('data')[0];\n\t\t\tgetEsriGeometry(data, this.id);\n\t\t});\n\t\t$(\".js-data-example-ajax\").select2({\n\t\t\t// placeholder: \"From\",\n\t\t\tallowClear: true,\n\t\t\tajax: {\n\t\t\t\turl: esriUrl + 'suggest?',\n\t\t\t\tdataType: 'jsonp',\n\t\t\t\tdelay: 250,\n\t\t\t\tdata: function (term, page) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttext: term, // search term\n\t\t\t\t\t\t// page: params.page,\n\t\t\t\t\t\t// outFields: 'City,Region',\n\t\t\t\t\t\tf: 'json',\n\t\t\t\t\t\tdistance: 20000,\n\t\t\t\t\t\tsearchExtents: '-85.386,34.618,-83.269,32.844',\n\t\t\t\t\t\tlocation: '-84.383149,33.750855',\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tresults: function (data, page) {\n\t\t\t\t\tconsole.log(data);\n\t\t\t\t\t// parse the results into the format expected by Select2.\n\t\t\t\t\t// since we are using custom formatting functions we do not need to\n\t\t\t\t\t// alter the remote JSON data\n\t\t\t\t\tvar res = data.suggestions;\n\t\t\t\t\tvar array = []\n\t\t\t\t\t$.each(res, function(i, item){\n\t\t\t\t\tvar arrItem = {\n\t\t\t\t\tid: item.magicKey,\n\t\t\t\t\ttext: item.text\n\t\t\t\t\t};\n\t\t\t\t\tarray.push(arrItem);\n\t\t\t\t\t});\n\t\t\t\t\treturn {\n\t\t\t\t\t\tresults: array\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tcache: true\n\t\t\t},\n\t\t\t// escapeMarkup: function (markup) { return markup; }, // let our custom formatter work\n\t\t\tminimumInputLength: 3,\n\t\t\ttemplateResult: function (option) {\n\t\t\t\treturn '<div class=\"clearfix\">' + option.text + '</div>';\n\t\t\t},\n\t\t\ttemplateSelection: function (option) {\n\t\t\t\treturn option.text;\n\t\t\t}\n\t\t});\n\t\tvar routeTypeMap = {\n\t\t\t'0': 'Tram',\n\t\t\t'1': 'Subway',\n\t\t\t'2': 'Rail',\n\t\t\t'3': 'Bus',\n\t\t\t'4': 'Ferry',\n\t\t\t'5': 'Cable',\n\t\t\t'6': 'Gondola',\n\t\t\t'7': 'Funicular'\n\t\t};\n\t\t// Geolocation\n\t\tif (\"geolocation\" in navigator) {\n\t\t\t/* geolocation is available */\n\t\t\tconsole.log('geolocation');\n\t\t\tconsole.log(navigator);\n\t\t\t\n\t\t\t// Check if geolocation is enabled\n\t\t\tnavigator.geolocation.getCurrentPosition(function(position) {\n\t\t\t\tgeolocationBool = true;\n\t\t\t\tlat = position.coords.latitude;\n\t\t\t\tlon = position.coords.longitude;\n\t\t\t\tconsole.log([position.coords.latitude, position.coords.longitude]);\n\t\t\t}, function (error) {\n\t\t\t  if (error.code == error.PERMISSION_DENIED)\n\t\t\t      console.log(\"you denied me :-(\");\n\t\t\t});\n\t\t} else {\n\t\t\t/* geolocation IS NOT available */\n\t\t}\n\t\t// Check if agency data exists\n\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/agencies-with-coverage.json?';\n\t\tvar params = {};\n\t\t// params.id = agencyId;\n\t\tparams.key = 'TEST';\n\t\turl += serialize(params);\n\t\t$.ajax({\n\t\t\turl: url,\n\t\t\tdataType: 'jsonp',\n\t\t\tsuccess: function(json){\n\t\t\t\tconsole.log(json.data.list);\n\t\t\t\tvar agencies = json.data.list;\n\t\t\t\t$.each(agencies, function(i, agency) {  \n\t\t\t\t\t$('.arrivals-agencies option[value='+agency.agencyId+']').removeAttr('disabled');\n\t\t\t\t});\n\t\t\t}\n\t\t}); // end ajax\n\n\t\t// Go back to previous view on planner widget carousels\n\t\t$('.planner-tab-li').click(function(e){\n\t\t\tvar widgetClass;\n\t\t\tif ($(this).hasClass('stop-code')){\n\t\t\t\twidgetClass = 'stop-code';\n\t\t\t}\n\t\t\telse{\n\t\t\t\twidgetClass = 'next';\n\t\t\t}\n\t\t\tif($(this).hasClass('active') && $('#' + widgetClass + '-carousel-inner > .active').index() === 1){\n\t\t\t\t// console.log('this is active');\n\t\t\t\t$('#' + widgetClass + '-back-btn').trigger('click');\n\t\t\t}\n\t\t});\n\t\t\n\t\t// Real-time agency select change\n\t\t$('input[type=radio][name=agency-arrivals-option], #next-arrivals-agencies').change(function(){\n\t\t\t$('#next-arrivals-routes').html('<option value=\"\">[Select Route]</option>');\n\t\t\t$('#next-arrivals-trips')\n\t\t\t\t.html('<option value=\"\">[Select Direction]</option>')\n\t\t\t\t.prop('disabled', true);\n\t\t\t$('#next-arrivals-stops')\n\t\t\t\t.html('<option value=\"\">[Select Stop]</option>')\n\t\t\t\t.trigger('change')\n\t\t\t\t.prop('disabled', true);\n\t\t\tconsole.log(this.value);\n\t\t\tif (this.value === 'Nearby'){\n\t\t\t\t$('#get-location').trigger('click');\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tvar agencyId = this.value;\n\t\t\tlocation.hash = 'agency=' + agencyId;\n\t\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/routes-for-agency/' + agencyId + '.json?';\n\t\t\tvar params = {};\n\t\t\t// params.id = agencyId;\n\t\t\tparams.key = 'TEST';\n\t\t\turl += serialize(params);\n\t\t\t$.ajax({\n\t\t\t\turl: url,\n\t\t\t\tdataType: 'jsonp',\n\t\t\t\tsuccess: function(json){\n\t\t\t\t\tconsole.log(json.data);\n\t\t\t\t\tvar routeNest = d3.nest()\n\t\t\t\t\t\t\t.key(function(d) { return d.type; })\n\t\t\t\t\t\t\t.sortValues(compareRouteNames)\n\t\t\t\t\t\t\t.map(json.data.list);\n\t\t\t\t\tconsole.log(routeNest);\n\t\t\t\t\tvar routes = json.data.list;\n\t\t\t\t\t$.each(routeNest, function(type, routes) {  \n\t\t\t\t\t\tvar optgroup = $('<optgroup>');\n\t\t\t\t\t\toptgroup.attr('label',routeTypeMap[type]);\n\t\t\t\t\t\t$.each(routes, function(i, route){\n\t\t\t\t\t\t\tvar option = $(\"<option></option>\");\n\t\t\t\t\t\t\tvar routeFullText = routeTypeMap[type] === 'Subway' ? route.shortName : route.shortName + ' - ' + route.longName;\n\t\t\t\t\t\t\tvar routeText = route.longName === '' ? route.shortName : routeFullText;\n\t\t\t\t\t\t\toption.val(route.id);\n\t\t\t\t\t\t\toption.text(routeText);\n\t\t\t\t\t\t\toptgroup.append(option);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$('#next-arrivals-routes').append(optgroup);\n\t\t\t\t\t});\n\t\t\t\t\t$('#next-arrivals-routes').prop('disabled', false);\n\t\t\t\t}\n\t\t\t}); // end ajax\n\t\t});\n\t\t// Use location \n\t\t$('#get-location').click(function(){\n\t\t\t$('#next-arrivals-agencies').val('Nearby');\n\t\t\t$('#next-arrivals-routes').html('<option value=\"\">[Select Route]</option>');\n\t\t\t$('#next-arrivals-stops')\n\t\t\t\t.html('<option value=\"\">[Select Stop]</option>')\n\t\t\t\t.trigger('change')\n\t\t\t\t.prop('disabled', true);\n\t\t\t$('#next-arrivals-trips')\n\t\t\t\t.html('<option value=\"\">[Select Direction]</option>')\n\t\t\t\t.prop('disabled', true);;\n\t\t\t$(this).val(moment().unix());\n\t\t\tif (geolocationBool && typeof lat !== 'undefined'){\n\t\t\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/routes-for-location.json?';\n\t\t\t\tvar params = {};\n\t\t\t\tparams.lat = lat;\n\t\t\t\tparams.lon = lon;\n\t\t\t\tparams.radius = 4000;\n\t\t\t\tparams.key = 'TEST';\n\t\t\t\turl += serialize(params);\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: url,\n\t\t\t\t\tdataType: 'jsonp',\n\t\t\t\t\tsuccess: function(json){\n\t\t\t\t\t\tconsole.log(json.data);\n\t\t\t\t\t\tvar routeNest = d3.nest()\n\t\t\t\t\t\t\t.key(function(d) { return d.agencyId; })\n\t\t\t\t\t\t\t.map(json.data.list);\n\t\t\t\t\t\tconsole.log(routeNest);\n\t\t\t\t\t\tvar agencyCount = 0;\n\t\t\t\t\t\tvar firstValue;\n\t\t\t\t\t\t$.each(routeNest, function(agency, routes) {  \n\t\t\t\t\t\t\tvar optgroup = $('<optgroup>');\n\t\t\t\t\t\t\toptgroup.attr('label',agency);\n\t\t\t\t\t\t\t$.each(routes, function(i, route){\n\t\t\t\t\t\t\t\tvar option = $(\"<option></option>\");\n\t\t\t\t\t\t\t\tif (agencyCount === 0 || i === 0){\n\t\t\t\t\t\t\t\t\tfirstValue = route.id;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar routeFullText = routeTypeMap[route.type] === 'Subway' ? route.shortName : route.shortName + ' - ' + route.longName;\n\t\t\t\t\t\t\t\tvar routeText = route.longName === '' ? route.shortName : routeFullText;\n\t\t\t\t\t\t\t\toption.val(route.id);\n\t\t\t\t\t\t\t\toption.text(routeText);\n\t\t\t\t\t\t\t\toptgroup.append(option);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t    $('#next-arrivals-routes').append(optgroup);\n\t\t\t\t\t\t    agencyCount++;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// $('#next-arrivals-routes').val(firstValue);\n\t\t\t\t\t\t$('#next-arrivals-routes').prop('disabled', false);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconsole.log('no geolocation available');\n\t\t\t}\n\t\t});\n\t\t// Select route change\n\t\t$('#next-arrivals-routes').change(function(){\n\t\t\tvar widgetClass;\n\t\t\tif ($(this).hasClass('nearby')){\n\t\t\t\twidgetClass = 'nearby';\n\t\t\t}\n\t\t\telse{\n\t\t\t\twidgetClass = 'next';\n\t\t\t}\n\t\t\t$('#next-arrivals-stops')\n\t\t\t\t.html('<option value=\"\">[Select Stop]</option>')\n\t\t\t\t.trigger('change')\n\t\t\t\t.prop('disabled', true);\n\t\t\t$('#next-arrivals-trips').html('<option value=\"\">[Select Direction]</option>');\n\t\t\tconsole.log(this.value);\n\t\t\tvar routeId = this.value;\n\t\t\tlocation.hash += '&route=' + routeId;\n\t\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/stops-for-route/' + routeId + '.json?';\n\t\t\tvar params = {};\n\t\t\tparams.key = 'TEST';\n\t\t\tparams.includePolylines = false;\n\t\t\turl += serialize(params);\n\t\t\t$.ajax({\n\t\t\t\turl: url,\n\t\t\t\tdataType: 'jsonp',\n\t\t\t\tsuccess: function(json){\n\t\t\t\t\tvar closestDistance = 10000000000;\n\t\t\t\t\tvar closestStop = '';\n\t\t\t\t\tvar selectedTrip;\n\t\t\t\t\tvar stopGroups = json.data.entry.stopGroupings[0].stopGroups;\n\t\t\t\t\tconsole.log(json.data.entry.stopGroupings[0].stopGroups);\n\t\t\t\t\tconsole.log(json.data);\n\t\t\t\t\tvar stopMap = d3.nest()\n\t\t\t\t\t\t.key(function(d) { return d.id; })\n\t\t\t\t\t\t.map(json.data.references.stops);\n\t\t\t\t\tvar tripMap = d3.nest()\n\t\t\t\t\t\t// .key(function(d) { return d.name.name; })\n\t\t\t\t\t\t// .key(function(d) { return d.tripHeadsign; })\n\t\t\t\t\t\t.key(function(d) { return d.id; })\n\t\t\t\t\t\t.map(stopGroups);\n\t\t\t\t\tconsole.log(stopMap);\n\t\t\t\t\tconsole.log(tripMap);\n\t\t\t\t\tconsole.log(routeId);\n\t\t\t\t\t// console.log(tripMap[routeId]);\n\t\t\t\t\tvar headsigns = [];\n\t\t\t\t\tvar tripCounter = 0;\n\t\t\t\t\t$.each(stopGroups, function(i, trip){\n\t\t\t\t\t\t// var tripId = trip.tripId;\n\t\t\t\t\t\t// console.log(trip.schedule.stopTimes);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// if (typeof tripMap[routeId][tripId] !== 'undefined' && tripMap[routeId][tripId][0].routeId === routeId && headsigns.indexOf(tripMap[routeId][tripId][0].tripHeadsign) === -1){\n\t\t\t\t\t\t\t// var headsign = tripMap[routeId][tripId][0].tripHeadsign;\n\t\t\t\t\t\t\t// headsigns.push(headsign);\n\t\t\t\t\t\t\tvar tripLabel = trip.name.name === '' ? trip.id : trimHeadsign(trip.name.name);\n\t\t\t\t\t\t\ttripLabel = +tripLabel === 1 ? 'Inbound' : tripLabel;\n\t\t\t\t\t\t\ttripLabel = +tripLabel === 0 ? 'Outbound' : tripLabel;\n\t\t\t\t\t\t\tconsole.log(tripLabel)\n\t\t\t\t\t\t\tvar tripOption = $(\"<option></option>\");\n\t\t\t\t\t\t\ttripOption.val(trip.id);\n\t\t\t\t\t\t\ttripOption.text(tripLabel);\n\t\t\t\t\t\t\t$('#next-arrivals-trips').append(tripOption);\n\t\t\t\t\t\t\tvar optgroup = $('<optgroup>');\n\t\t\t\t\t\t\toptgroup.attr('id', trip.id);\n\t\t\t\t\t\t\toptgroup.attr('label',tripLabel);\n\t\t\t\t\t\t\tif (tripCounter === 0){\n\t\t\t\t\t\t\t\tselectedTrip = trip.id;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\toptgroup.addClass('hidden-optgroup');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t$.each(trip.stopIds, function(j, stopId){\n\t\t\t\t\t\t\t\tvar stop = stopMap[stopId][0];\n\t\t\t\t\t\t\t\t// console.log(stop)\n\t\t\t\t\t\t\t\tvar distance = \"\";\n\t\t\t\t\t\t\t\tif (typeof lat !== \"undefined\" && geolocationBool){\n\t\t\t\t\t\t\t\t\tdistance = getDistanceFromLatLonInKm(stop.lat, stop.lon, lat, lon);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (tripCounter === 0){\n\t\t\t\t\t\t\t\t\t\tif (distance < closestDistance){\n\t\t\t\t\t\t\t\t\t\t\tclosestDistance = distance;\n\t\t\t\t\t\t\t\t\t\t\tclosestStop = stop.id;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar option = $(\"<option></option>\");\n\t\t\t\t\t\t\t\toption.val(stop.id);\n\t\t\t\t\t\t\t\tif (geolocationBool && typeof lat != 'undefined'){\n\t\t\t\t\t\t\t\t\toption.attr('distance', distance);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar stopName = cleanStopName(stop.name);\n\t\t\t\t\t\t\t\tvar stopDir = stop.direction !== '' ? '(' + stop.direction + ') ' : '';\n\t\t\t\t\t\t\t\toption.text(stopDir + stopName);\n\t\t\t\t\t\t\t\toptgroup.append(option);\n\t\t\t\t\t\t\t\t// $('#' + widgetClass + '-arrivals-stops').append(option);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t$('#' + widgetClass + '-arrivals-stops').append(optgroup);\n\t\t\t\t\t\t\ttripCounter++;\n\t\t\t\t\t\t// } // end if valid trip for route\n\n\t\t\t\t\t}); // end each trip\n\t\t\t\t\tvar $stops = $('#next-arrivals-stops');\n\t\t\t\t\t$('#next-arrivals-trips').prop('disabled', false);\n\t\t\t\t\t$('#next-arrivals-trips').val(selectedTrip);\n\t\t\t\t\t$stops.prop('disabled', false);\n\t\t\t\t\tif (geolocationBool && typeof lat !== 'undefined'){\n\t\t\t\t\t\t$stops.val(closestStop);\n\t\t\t\t\t}\n\t\t\t\t\tif ($stops.val() !== ''){\n\t\t\t\t\t\t$stops.trigger('change');\n\t\t\t\t\t}\n\t\t\t\t\tif ($('#next-arrivals-stops').val() !== ''){\n\t\t\t\t\t\t$('#next-arrivals-btn').prop('disabled', false);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\t$('#next-arrivals-btn').prop('disabled', true);\n\t\t\t\t\t}\n\t\t\t\t} // end success\n\t\t\t}); // end ajax\n\t\t});\n\t\t// $('.arrivals-routes').change(function(){\n\t\t// });\n\t\tvar previousTrip;\n\t\t$('#next-arrivals-trips')\n\t\t\t.on('focus', function () {\n\t\t\t\t// Store the current value on focus and on change\n\t\t\t\tpreviousTrip = this.value;\n\t\t    }).change(function(){\n\t\t    \tvar closestDistance = 10000000000;\n\t\t\t\tvar closestStop = '';\n\t\t\t\tconsole.log(this.value);\n\t\t\t\t$('#' + previousTrip).addClass('hidden-optgroup');\n\t\t\t\t$('#' + this.value).removeClass('hidden-optgroup');\n\t\t\t\tif (geolocationBool){\n\t\t\t\t\t$('#' + this.value + ' > option').each(function(){\n\t\t\t\t\t\tvar distance = $(this).attr('distance');\n\t\t\t\t\t\tconsole.log(distance);\n\t\t\t\t\t\tif (distance < closestDistance){\n\t\t\t\t\t\t\tclosestDistance = distance;\n\t\t\t\t\t\t\tclosestStop = this.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tconsole.log(closestStop);\n\t\t\t\tvar $stops = $('#next-arrivals-stops');\n\t\t\t\tif (closestStop !== ''){\n\t\t\t\t\t$stops.val(closestStop);\n\t\t\t\t\tif ($stops.val() !== ''){\n\t\t\t\t\t\t$stops.trigger('change');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t});\n\t\t$('#next-arrivals-stops').change(function(){\n\t\t\tvar stopId = this.value;\n\t\t\tconsole.log(stopId);\n\t\t\tif (stopId !== ''){\n\t\t\t\t$('#next-arrivals-btn')\n\t\t\t\t\t.removeClass('disabled')\n\t\t\t\t\t.removeAttr('disabled')\n\t\t\t\t\t.val(stopId);\n\t\t\t\t\n\t\t\t\tlocation.hash += '&stop=' + stopId;\n\n\t\t\t\t$('.get-schedules').removeClass('disabled');\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$('#next-arrivals-btn')\n\t\t\t\t\t.addClass('disabled')\n\t\t\t\t\t.attr('disabled', 'disabled')\n\t\t\t\t\t.val('');\n\t\t\t\t$('.get-schedules').addClass('disabled');\n\t\t\t}\n\t\t});\n\t\t$('#stop-code').on('keyup', function(e){\n\t\t\tvar tableId = '#stop-code-arrivals-table';\n\t\t\tvar table = $(tableId);\n\t\t\t\n\t\t\tvar stopCode = $('#stop-code').val() === '' ? '103134' : $('#stop-code').val();\n\t\t\tif (this.value.length < 6){\n\t\t\t\tconsole.log(this.value);\n\t\t\t\t$('#stop-code-error-msg').html('Please enter a valid <strong>six-digit</strong> stop ID.');\n\t\t\t\t$('#stop-code-arrivals-btn')\n\t\t\t\t\t.addClass('disabled')\n\t\t\t\t\t.val('');\n\t\t\t}\n\t\t\telse if (this.value.length === 6){\n\t\t\t\tconsole.log(e);\n\t\t\t\tconsole.log(this.value);\n\t\t\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/stops-for-location.json?';\n\t\t\t\tvar params = {};\n\t\t\t\tparams.query = stopCode;\n\t\t\t\tparams.key = 'TEST';\n\t\t\t\turl += serialize(params);\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: url,\n\t\t\t\t\tdataType: 'jsonp',\n\t\t\t\t\tsuccess: function(json){\n\t\t\t\t\t\tconsole.log(json.data);\n\t\t\t\t\t\tif (json.data.list.length > 0){\n\t\t\t\t\t\t\tstopId = json.data.list[0].id;\n\t\t\t\t\t\t\tstopName = cleanStopName(json.data.list[0].name);\n\t\t\t\t\t\t\t// $('.get-next-stop-code').removeClass('btn-danger').addClass('btn-primary');\n\t\t\t\t\t\t\t$('#stop-code-arrivals-btn')\n\t\t\t\t\t\t\t\t.removeClass('disabled')\n\t\t\t\t\t\t\t\t.val(stopId);\n\t\t\t\t\t\t\t$('#stop-code-error-msg').html('Stop: <strong>' + stopName + '</strong>');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\ttable.hide();\n\t\t\t\t\t\t\t$('#nearby-arrival-msg').text('No arrivals.');\n\t\t\t\t\t\t\t$('#nearby-arrival-msg').show();\n\t\t\t\t\t\t\t$('#stop-code-error-msg').html('Unknown stop ID.');\n\t\t\t\t\t\t\t$('#stop-code-arrivals-btn')\n\t\t\t\t\t\t\t\t.addClass('disabled')\n\t\t\t\t\t\t\t\t.val('');;\n\t\t\t\t\t\t\t// $('.get-next-stop-code').removeClass('btn-primary').addClass('btn-danger');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} // end if stop code length === 6\n\t\t\telse {\n\t\t\t\t$('#stop-code-arrivals-btn')\n\t\t\t\t\t.addClass('disabled')\n\t\t\t\t\t.val('');\n\t\t\t\t$('#stop-code-error-msg').html('Please enter a valid <strong>six-digit</strong> stop ID.');\n\t\t\t}\n\t\t});\n\t\t$('.get-arrivals').click(function(){\n\t\t\tvar widgetClass, stopId;\n\t\t\t\n\t\t\tif ($(this).hasClass('stop-code')){\n\t\t\t\twidgetClass = 'stop-code';\n\t\t\t}\n\t\t\telse{\n\t\t\t\twidgetClass = 'next';\n\t\t\t}\n\t\t\tvar tableId = '#' + widgetClass + '-arrivals-table';\n\t\t\tvar table = $(tableId);\n\t\t\tstopId = $('#' + widgetClass + '-arrivals-btn').val();\n\n\t\t\tconsole.log(stopId);\n\t\t\tconsole.log(widgetClass);\n\t\t\tif (stopId !== ''){\n\t\t\t\t// console.log('stop coding it up');\n\t\t\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/arrivals-and-departures-for-stop/' + stopId + '.json?';\n\t\t\t\tvar params = {};\n\t\t\t\tparams.key = 'TEST';\n\t\t\t\tparams.minutesBefore = 1;\n\t\t\t\turl += serialize(params);\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: url,\n\t\t\t\t\tdataType: 'jsonp',\n\t\t\t\t\tsuccess: function(json){\n\t\t\t\t\t\tvar arrivals = json.data.entry.arrivalsAndDepartures;\n\t\t\t\t\t\tconsole.log(json.data);\n\t\t\t\t\t\tvar stopMap = d3.nest()\n\t\t\t\t\t\t\t.key(function(d) { return d.id; })\n\t\t\t\t\t\t\t.map(json.data.references.stops);\n\n\t\t\t\t\t\tconsole.log(json.data.entry.arrivalsAndDepartures);\n\t\t\t\t\t\tif (arrivals.length > 0){\n\t\t\t\t\t\t\tstopName = stopMap[json.data.entry.stopId][0].name;\n\t\t\t\t\t\t\t$('#' + widgetClass + '-stop-id').html(cleanStopName('Stop ID: ' + stopId.split('_')[1]));\n\t\t\t\t\t\t\t$('#' + widgetClass + '-stop-name').html(cleanStopName(stopName));\n\t\t\t\t\t\t\t$('#' + widgetClass + '-last-updated .time').html(moment(arrivals[0].lastUpdateTime).format('h:mm a'));\n\t\t\t\t\t\t\t$('#nearby-arrival-msg').hide();\n\t\t\t\t\t\t\ttable.show();\n\t\t\t\t\t\t\ttable.empty();\n\n\t\t\t\t\t\t\t// var header = $('<thead>');\n\t\t\t\t\t\t\t// header.append('<tr><')\n\t\t\t\t\t\t\ttable.append('<thead><tr><th>Route</th><th>Minutes</th><th>Direction</th></tr></thead>');\n\t\t\t\t\t\t\tvar tbody = $('<tbody>');\n\t\t\t\t\t\t\tvar data = [];\n\t\t\t\t\t\t\tfor (var i = 0; i < arrivals.length; i++) {\n\t\t\t\t\t\t\t\t// if (i < 8) {\n\t\t\t\t\t\t\t\t\tvar predicted = arrivals[i].predictedArrivalTime ? true : false;\n\t\t\t\t\t\t\t\t\tvar seconds = arrivals[i].predictedArrivalTime || arrivals[i].scheduledArrivalTime;\n\t\t\t\t\t\t\t\t\tvar diff = seconds - moment().valueOf();\n\t\t\t\t\t\t\t\t\tvar routeName = arrivals[i].routeShortName;\n\t\t\t\t\t\t\t\t\t// console.log(diff);\n\t\t\t\t\t\t\t\t\t// var minutes = String(Math.floor(divisor_for_minutes / 60));\n\t\t\t\t\t\t\t\t\tvar fromNow = Math.floor(diff/60/1000);//moment(seconds).toNow(true)//.replace('minutes', '').replace('a few seconds', '<strong>NOW</strong>').replace('a minute', '<strong>NOW</strong>');\n\t\t\t\t\t\t\t\t\tvar fromNowText = fromNow <= 1 ? '<strong>NOW</strong>' : fromNow;\n\t\t\t\t\t\t\t\t\tvar headsign = trimHeadsign(arrivals[i].tripHeadsign);\n\t\t\t\t\t\t\t\t\tvar patt = new RegExp(\"Airport\");\n\t\t\t\t\t\t\t\t\tif (patt.test(headsign)){\n\t\t\t\t\t\t\t\t\t\theadsign += ' <i class=\"fa fa-plane\"></i>';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t// data.push([\n\t\t\t\t\t\t\t\t\t// \tarrivals[i].routeShortName, \n\t\t\t\t\t\t\t\t\t// \tfromNow, \n\t\t\t\t\t\t\t\t\t// \theadsign, \n\t\t\t\t\t\t\t\t\t// \t+seconds\n\t\t\t\t\t\t\t\t\t// ]);\n\t\t\t\t\t\t\t\t\tvar row = $('<tr class=\"info\">');\n\t\t\t\t\t\t\t\t\tif (predicted){\n\t\t\t\t\t\t\t\t\t\tfromNowText += ' <i style=\"font-size:0.7em;\" alt=\"Predicted arrival time\" title=\"Predicted arrival time\" class=\"fa fa-bolt\"></i>';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\trow.append('<td><span class=\"'+labelMap[routeName]+'\">' + routeName + '</span></td>');\n\t\t\t\t\t\t\t\t\trow.append('<td data-order=\"'+fromNow+'\">' + fromNowText + '</td>');\n\t\t\t\t\t\t\t\t\trow.append('<td>' + headsign + '</td>');\n\t\t\t\t\t\t\t\t\ttbody.append(row);\n\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttable.append(tbody);\n\t\t\t\t\t\t\tconsole.log(data);\n\t\t\t\t\t\t\tif ( $.fn.dataTable.isDataTable(tableId) ) {\n\t\t\t\t\t\t\t\tarrivalsDatatable = table.DataTable();\n\t\t\t\t\t\t\t\t// arrivalsDatatable.clear();\n\t\t\t\t\t\t\t\t// arrivalsDatatable.rows.add(data);\n\t\t\t\t\t\t\t\t// arrivalsDatatable.draw();\n\t\t\t\t\t\t\t\tarrivalsDatatable.destroy();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// else {\n\t\t\t\t\t\t\t\tarrivalsDatatable = table.DataTable( {\n\t\t\t\t\t\t\t\t\t\"order\": [[ 1, \"asc\" ]],\n\t\t\t\t\t\t\t\t\t// \"columns\": [\n\t\t\t\t\t\t\t\t\t// \t{\"title\": \"Route\"},\n\t\t\t\t\t\t\t\t\t// \t{\"title\": \"Minutes\"},\n\t\t\t\t\t\t\t\t\t// \t{\"title\": \"Direction\"},\n\t\t\t\t\t\t\t\t\t// \t{\"title\": \"diff\", \"type\": \"num\"}\n\t\t\t\t\t\t\t\t\t// ],\n\t\t\t\t\t\t\t\t\t// \"columnDefs\": [\n\t\t\t\t\t\t\t\t\t// \t// \"targets\": [ 2 ],\n\t\t\t\t\t\t\t\t\t// \t// \"visible\": false\n\t\t\t\t\t\t\t\t\t// \t// { \"type\": \"num\", \"targets\": 0 }\n\t\t\t\t\t\t\t\t\t// \t{ \"visible\": false, \"targets\": 3 },\n\t\t\t\t\t\t\t\t\t// \t// { \"orderData\": 1,    \"targets\": 3 },\n\t\t\t\t\t\t\t\t\t// ],\n\t\t\t\t\t\t\t\t\t// \"data\": data,\n\t\t\t\t\t\t\t\t\t\"paging\": false,\n\t\t\t\t\t\t\t\t\t// \"pageLength\": 6,\n\t\t\t\t\t\t\t\t\t// \"ordering\": false,\n\t\t\t\t\t\t\t\t\t\"info\": false,\n\t\t\t\t\t\t\t\t\t\"bFilter\": false\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t} // end if there are arrivals in the list\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\ttable.hide();\n\t\t\t\t\t\t\t$('#' + widgetClass + '-stop-name').html('');\n\t\t\t\t\t\t\t$('#' + widgetClass + '-last-updated').html('');\n\t\t\t\t\t\t\t$('#' + widgetClass + '-arrival-msg').text('No arrivals in the next 30 minutes.');\n\t\t\t\t\t\t\t$('#' + widgetClass + '-arrival-msg').show();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (widgetClass === 'next'){\n\t\t\t\t$('#next-carousel').carousel('next');\n\t\t\t}\n\t\t});\n\t\t$('.plan-control').change(function(){\n\n\t\t});\n\t\t$(\".planner-go-btn\").click(function(){\n\t\t\tvar params = {};\n\t\t\t// var plannerChoice = $('.planner-choice-btn').val();\n\t\t\tvar plannerChoice = $(this).text();\n\t\t\tvar origin = $('#planner-options-from-latlng').val();\n\t\t\tvar destination = $('#planner-options-dest-latlng').val();\n\t\t\tvar time = $('#planner-timepicker').val();\n\t\t\tif (origin && destination && time){\n\t\t\t\t// Continue with trip plan\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$('#planner-message')\n\t\t\t\t\t.fadeIn()\n\t\t\t\t\t.html('Please add a valid origin, destination, and time.')\n\t\t\t\t\t.delay(2000)\n\t\t\t\t\t.fadeOut('slow');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (/Google/.test(plannerChoice)){\n\t\t\t\tparams.saddr = origin;\n\t\t\t    params.daddr = destination;\n\t\t\t    params.dirflg = 'r';\n\t\t\t\tvar googUrl = 'http://maps.google.com/?';\n\t\t\t\t// window.location.href = googUrl + serialize(params); \n\t\t\t\twindow.open(googUrl + serialize(params),'_blank');\n\t\t\t}\n\t\t\telse{\n\t\t\t\tparams.fromPlace = origin;\n\t\t\t    params.toPlace = destination;\n\t\t\t    params.arriveBy = $(\".planner-time-btn:first-child\").val() === 'Arrive by' ? true : false;\n\t\t\t    params.date = moment().format('YYYY-MM-DD');\n\t\t\t    params.time = $(\".planner-time-btn:first-child\").val() === 'Leave now' ? moment().valueOf() : getTime();\n\t\t\t    params.fromName = $('#planner-options-from').val() // $('#from').select2('data')[0].text;\n\t\t\t\t// params.toPlace = $('#planner-options-dest-latlng').val();\n\t\t\t\tparams.toName = $('#planner-options-dest').val() // $('#to').select2('data')[0].text;\n\t\t\t\tparams.mode = 'TRANSIT,WALK'; // $('input[name=mode-select]:checked').val()\n\t\t\t\tvar atltransitUrl = '/plan#';\n\t\t\t\t// console.log(atltransitUrl + serialize(params));\n\t\t\t\twindow.location.href = atltransitUrl + serialize(params);\n\t\t\t}\n\t\t\t// window.location.href='{{ site.baseurl }}/plan' + params;\n\t\t});\n\t    $(\".planner-time-menu li a\").click(function(){\n\n\t      $(\".planner-time-btn:first-child\").html('<i class=\"fa fa-clock-o right-5\"></i>' + $(this).text() + '<i class=\"fa fa-caret-down left-5\"></i>');\n\t      $(\".planner-time-btn:first-child\").val($(this).text());\n\t      var val = $(\".planner-time-btn:first-child\").val();\n\t      if (val === 'Depart at' || val === 'Arrive by'){\n\t      \t$('#planner-options-inputgroup-time').show();\n\t      }\n\t      else{\n\t      \t$('#planner-options-inputgroup-time').hide();\n\t      }\n\t   });\n\n\t   $(\".planner-choice-menu li a\").click(function(){\n\t      $(\".planner-choice-btn:first-child\").html($(this).text());\n\t      $(\".planner-choice-btn:first-child\").val($(this).text());\n\t   });\n\t //   $('.box').click(function() {\n\n\t\t//     $(this).animate({\n\t\t//         left: '-50%'\n\t\t//     }, 500, function() {\n\t\t//         $(this).css('left', '150%');\n\t\t//         $(this).appendTo('#box-container');\n\t\t//     });\n\n\t\t//     $(this).next().animate({\n\t\t//         left: '50%'\n\t\t//     }, 500);\n\t\t// });\n\t\t$('#trig').on('click', function () {\n\t\t    $('#col1').toggleClass('col-md-12 col-md-3');\n\t\t    $('#col2').toggleClass('col-md-0 col-md-9');\n\t\t});\n\t});\n// }","function compareRouteNames (a, b) { return a.shortName - b.shortName; }\nfunction findBootstrapEnvironment () {\n  var envs = ['xs', 'sm', 'md', 'lg']\n\n  $el = $('<div>')\n  $el.appendTo($('body'))\n\n  for (var i = envs.length - 1; i >= 0; i--) {\n    var env = envs[i]\n\n    $el.addClass('hidden-' + env)\n    if ($el.is(':hidden')) {\n      $el.remove()\n      return env\n    }\n  }\n}\n// function setupAutoComplete(inputId){\n//   console.log('setting up autocomplete for ' + inputId)\n//   if (typeof inputId !== 'undefined'){\n//     $( \"#\" + inputId ).autocomplete({\n//           autoFocus: true,\n//           minLength: 0,\n//           //appendTo: \"#planner-options-from-autocompletecontainer\",\n//           messages : Locale.autocompleteMessages,\n//           source: Geocoder.geocoder,\n//           search: function( event, ui ) {\n//               $( \"#\" + inputId + \"-latlng\" ).val( \"\" )\n//           },\n//           focus: function( event, ui ) {\n//               // $( \"#planner-options-from\" ).val( ui.item.label )\n//               //$( \"#planner-options-from-latlng\" ).val( ui.item.latlng )\n//               console.log('focus up toPlace')\n//               return false\n//           },\n//       select: function( event, ui ) {\n//         $( \"#project-description\" ).html( ui.item.desc )\n//         console.log(ui.item)\n//         var point\n//         if (typeof markers['originMarker'] !== 'undefined'){\n//           map.removeLayer(markers['originMarker'])\n//         }\n//         if (/Your location/g.test(ui.item.label)){\n//           console.log('your location selected')\n//           $( \"#\" + inputId ).val( ui.item.desc )\n//           point = ui.item.desc.split(\",\")\n//           if (typeof map !== 'undefined'){\n//             addMarker({lat:Number(point[0]),lng:Number(point[1])}, ui.item.label, \"originMarker\", 'form')\n//           }\n//           $( \"#planner-options-from-latlng\" ).val( ui.item.desc )\n//           return false\n//         }\n//         else{\n//           $( \"#\" + inputId ).val( ui.item.label )\n//           var params = {\n//             text: ui.item.label,\n//             magicKey: ui.item.key,\n//             f: 'pjson'\n//           }\n//           $.ajax(esri_url + 'find', {\n//             data : params,\n//             success: function( data ) {\n//             var json = JSON.parse(data)\n//             console.log(json)\n//             var geometry = json.locations[0].feature.geometry\n//             if (typeof map !== 'undefined'){\n//               addMarker({lat:Number(geometry.y),lng:Number(geometry.x)}, ui.item.label, \"originMarker\", 'form')\n//             }\n//             $( \"#\" + inputId + \"-latlng\" ).val( geometry.y + ',' + geometry.x )\n//             return false\n//                   }\n//                 })\n//               } \n//           }\n\n//       })\n//     .focus(function(){\n//       console.log('focus')\n//       if (typeof lat !== 'undefined'){\n//         $(this).autocomplete('search')\n//       }\n//       console.log(this.id)\n//     })\n//     .data(\"ui-autocomplete\")._renderItem = function (ul, item) {\n//       return $(\"<li></li>\")\n//         .data(\"item.autocomplete\", item)\n//         .append(\"<b>\" + item.label + \"</b><br>\" + item.desc) //+ \"</a>\")\n//         .appendTo(ul)\n//     }\n//   }\n// }\nfunction setupDatetime () {\n  // if(Modernizr.inputtypes.time){\n  $('#planner-options-timeformat').hide()\n  $('#planner-options-timeformat').attr('aria-hidden', true)\n  // }\n  setTime(currentTime)\n  function pad (n) { return n < 10 ? '0' + n : n }\n  var date = currentTime.year() + '-' + pad(currentTime.month() + 1) + '-' + pad(currentTime.date())\n  setDate(date)\n  if (typeof $().datepicker === 'function') {\n    $('#planner-options-date').datepicker({\n      dateFormat: Locale.dateFormat,\n      dayNames: Locale.days,\n      dayNamesMin: Locale.daysMin,\n      monthNames: Locale.months,\n      defaultDate: 0,\n      hideIfNoPrevNext: true,\n      minDate: whitelabel_minDate,\n      maxDate: whitelabel_maxDate\n    })\n  } else {\n    console.log('error no datetimepicker')\n  }\n  /* Read aloud the selected dates */\n  $(document).on('mouseenter', '.ui-state-default', function () {\n    var text = $(this).text() + ' ' + $('.ui-datepicker-month', $(this).parents()).text() + ' ' + $('.ui-datepicker-year', $(this).parents()).text()\n    $('#planner-options-date-messages').text(text)\n  })\n\n  // if(Modernizr.inputtypes.date){\n  $('#planner-options-dateformat').hide()\n  $('#planner-options-dateformat').attr('aria-hidden', true)\n// }\n}\nfunction setDate (iso8601) {\n  parts = iso8601.split('-')\n  var d = moment(iso8601)\n  $('#planner-options-date').val(d.format('MM-DD-YYYY'))\n}\nfunction setTime (iso8601) {\n  // if(Modernizr.inputtypes.time){\n  //     $('#planner-options-time').val(iso8601.slice(0,5))\n  // }else{\n  console.log(iso8601)\n  input = moment(iso8601, 'hh:mm a')\n  // var secs = parseInt(val[0])*60*60+parseInt(val[1])*60\n  // var hours = String(Math.floor(secs / (60 * 60)) % 24)\n  // var divisor_for_minutes = secs % (60 * 60)\n  // var minutes = String(Math.floor(divisor_for_minutes / 60))\n  console.log(input.format('HH:mm'))\n\n  $('#planner-options-time').val(input.format('HH:mm'))\n// }\n}\n\nfunction getDate () {\n  return moment($('#planner-options-date').val(), 'MM-DD-YYYY').format('YYYY-MM-DD')\n}\nfunction getTime () {\n  var time = moment($('#planner-options-time').val(), 'HH:mm')\n  return time.format('hh:mm a')\n}\n// Scrolls to anchor tag from subnav link\nfunction scrollToAnchor (aid) {\n  if (typeof aid !== 'undefined') {\n    console.log(aid)\n    var aTag = $(\"[id='\" + aid + \"']\")\n    console.log(aTag)\n    scrollToOffset(aTag.offset().top)\n  } else {\n    scrollToOffset(0)\n  }\n}\n\nfunction scrollToOffset (offset) {\n  $('html,body').animate({\n    scrollTop: offset // - 60\n  }, 'slow')\n}\n\n$('.toc a').click(function (e) {\n  e.preventDefault()\n\n  var hash = $(this).attr('href').split('#')[1]\n  history.pushState(null, null, '#' + hash)\n  scrollToAnchor($(this).attr('href').split('#')[1])\n})\n\n// Set all thumbnails to same height\nfunction equalHeight (group) {\n  var tallest = 0\n\n  group.each(function () {\n    $(this).css({'height': ''})\n    var thisHeight = $(this).height()\n    console.log(thisHeight)\n    if (thisHeight > tallest) {\n      tallest = thisHeight\n    }\n  })\n  console.log('resizing...' + tallest)\n  group.each(function () { $(this).height(tallest); })\n}\n// Bind the function to global jQuery object.\n$.fn.reveal = function () {\n  // Arguments is a variable which is available within all functions\n  // and returns an object which holds the arguments passed.\n  // It is not really an array, so by calling Array.prototype\n  // he is actually casting it into an array.\n  var args = Array.prototype.slice.call(arguments)\n\n  // For each elements that matches the selector:\n  return this.each(function () {\n    // this is the dom element, so encapsulate the element with jQuery.\n    var img = $(this),\n      src = img.data('src')\n\n    // If there is a data-src attribute, set the attribute\n    // src to make load the image and bind an onload event.\n    src && img.attr('src', src).load(function () {\n      // Call the first argument passed (like fadeIn, slideIn, default is 'show').\n      // This piece is like doing img.fadeIn(1000) but in a more dynamic way.\n      img[args[0] || 'show'].apply(img, args.splice(1))\n    })\n  })\n}\n$(document).ready(function () {\n  // Initialize lazy loading\n  // var layzr = new Layzr({\n  //       callback: function() {\n  //         // equalHeight($(\".equal-height\"))\n  //       }\n  // })\n  // $(\"img\").reveal(\"fadeIn\", 1000)\n  // equalHeight($(\".equal-height\")); \n})\n\n// Check equal-height height on resize\n\nvar waitForFinalEvent = (function () {\n  var timers = {}\n  return function (callback, ms, uniqueId) {\n    if (!uniqueId) {\n      uniqueId = \"Don't call this twice without a uniqueId\"\n    }\n    if (timers[uniqueId]) {\n      clearTimeout(timers[uniqueId])\n    }\n    timers[uniqueId] = setTimeout(callback, ms)\n  }\n})()\n\n$(window).resize(function () {\n  waitForFinalEvent(function () {\n    // equalHeight($(\".equal-height\"))\n    // ...\n  }, 500, 'some unique string')\n})\n\njQuery.unparam = function (value) {\n  if (value.length > 1 && value.charAt(0) == '#') {\n    value = value.substring(1)\n  }\n  var\n    // Object that holds names => values.\n    params = {},\n    // Get query string pieces (separated by &)\n    pieces = value.split('&'),\n    // Temporary variables used in loop.\n    pair, i, l\n\n  // Loop through query string pieces and assign params.\n  for (i = 0, l = pieces.length; i < l; i++) {\n    pair = pieces[i].split('=', 2)\n    // Repeated parameters with the same name are overwritten. Parameters\n    // with no value get set to boolean true.\n    params[decodeURIComponent(pair[0])] = (pair.length == 2 ?\n      decodeURIComponent(pair[1].replace(/\\+/g, ' ')) : true)\n  }\n  console.log(params)\n  return params\n}\n// Extended disable function\njQuery.fn.extend({\n  disable: function (state) {\n    return this.each(function () {\n      var $this = $(this)\n      if ($this.is('input, button, a'))\n        this.disabled = state\n      else\n        $this.toggleClass('disabled', state)\n    })\n  }\n})\nfunction trimHeadsign (headsign) {\n  headsign = headsign.split('-').length > 1 ? headsign.split('-')[1] : headsign\n  headsign = headsign.split('TO').length > 1 ? headsign.split('TO')[1] : headsign\n  headsign = headsign.replace(/STATION/i, '')\n  headsign = toTitleCase(headsign)\n\n  return headsign\n}\nfunction cleanStopName (name) {\n  name = name\n    .replace(/(@)(?!\\s)/g, ' @ ')\n    .replace(/(\\/)(?!\\s)/g, ' / ')\n    .replace(/STATION/g, '')\n  name = toTitleCase(name)\n  return name\n\n}\nfunction getDistanceFromLatLonInKm (lat1, lon1, lat2, lon2) {\n  var R = 6371 // Radius of the earth in km\n  var dLat = deg2rad(lat2 - lat1) // deg2rad below\n  var dLon = deg2rad(lon2 - lon1)\n  var a =\n  Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\n    Math.sin(dLon / 2) * Math.sin(dLon / 2)\n\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))\n  var d = R * c // Distance in km\n  return d\n}\nfunction deg2rad (deg) {\n  return deg * (Math.PI / 180)\n}\nfunction toTitleCase (str) {\n  return str.replace(/\\w\\S*/g, function (txt) {\n    if (/LCI|CTP|TDM|CSX|^NW$|^NE$|^SE$|^SW$|MARTA|GWCC|CNN|^FY$|^ARC$|^SR$|^II$|^STP$|^III$|^US$|CMAQ/g.test(txt))\n      return txt\n    else if (/^IN$|^OF$|^AND$|^FOR$/g.test(txt)) {\n      return txt.toLowerCase()\n    }\n    else\n      return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()\n  })\n}\nserialize = function (obj, prefix) {\n  var str = []\n  for (var p in obj) {\n    if (obj.hasOwnProperty(p)) {\n      var k = prefix ? prefix + '[' + p + ']' : p, v = obj[p]\n      str.push(typeof v == 'object' ?\n        serialize(v, k) :\n        encodeURIComponent(k) + '=' + encodeURIComponent(v))\n    }\n  }\n  return str.join('&')\n}\nvar bs = findBootstrapEnvironment()\nconsole.log(bs)\nif (bs === 'md' || bs === 'sm') {\n  $('.agency-arrivals-radio').addClass('btn-xs')\n}\n","var whitelabel_prefix = 'http://opentrip.atlantaregion.com/otp-rest-servlet/';\n\nvar whitelabel_minDate = new Date(2014, 02, 08);\nvar whitelabel_maxDate = new Date(2020, 03, 30);\n\nvar Locale = {};\n\nLocale.dateFormat = 'mm-dd-yy';\nLocale.timeFormat = 'h:mma';\nLocale.dateAriaLabel = 'Date, use Ctrl en arrow keys to navigate, enter to choose';\nLocale.loading = \"Loading...\";\nLocale.edit = \"Change trip\";\nLocale.plan = \"Plan trip\";\nLocale.geocoderInput = \"Enter starting address...\";\nLocale.originInput = \"Enter starting address...\";\nLocale.destinationInput = \"Enter destination...\";\nLocale.startpointEmpty = \"No starting point entered\";\nLocale.noStartpointSelected = \"No starting point selected\";\nLocale.destinationEmpty = \"No destination entered\";\nLocale.noDestinationSelected = \"No destination selected\";\nLocale.noValidDate = \"Enter a valid date\";\nLocale.noValidTime = \"Enter a valid time\";\nLocale.dateTooEarly = function ( minDate8601 ) { return \"This trip planner works for travel dates starting \"+minDate8601.split('-').reverse().join('-'); };\nLocale.dateTooLate = function ( maxDate8601 ) { return \"This trip planner works for travel dates till \"+maxDate8601.split('-').reverse().join('-'); };\nLocale.from = \"From\";\nLocale.via = \"Via\";\nLocale.to = \"To\";\nLocale.date = \"Date\";\nLocale.time = \"Time\";\nLocale.months = ['January','February','March','April','May','June','July','August','September','October','November','December'];\nLocale.days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];\nLocale.daysMin = ['Su','Mo','Tu','We','Th','Fr','Sa'];\nLocale.earlier = 'Earlier';\nLocale.later = 'Later';\nLocale.noAdviceFound = 'No valid trips found';\nLocale.walk = 'Walk';\nLocale.platformrail = 'Platform';\nLocale.platform = 'Platform';\nLocale.amountTransfers = function ( transfers ) { if (transfers === 0) { return 'Direct'; } else { return transfers+ ' transfers';} };\nLocale.autocompleteMessages = {\n        noResults: \"No results found.\",\n        results: function( amount ) {\n            return amount + ( amount > 1 ? \" results are \" : \" result is\" ) + \" available, use the up and down arrow keys to navigate them.\";\n        }\n};","$('.nav-search').submit(function(e){\n\te.preventDefault();\n\tconsole.log(this.value);\n});\n\n\n\n// For fare table tooltips\n$('[data-toggle=\"tooltip\"]').tooltip();\n\n// Close currently open nav div when another is clicked\n// http://stackoverflow.com/a/23973965/915811\n$(\"[data-collapse-group='navbarCollapse']\").click(function (e) {\n\te.preventDefault();\n    var $this = $(this);\n    console.log(this);\n    $(\"[data-collapse-group='navbarCollapse']:not([data-target='\" + $this.data(\"target\") + \"'])\").each(function () {\n    \t$(this).addClass('collapsed');\n    \tconsole.log(this);\n        $($(this).data(\"target\")).removeClass(\"in\").addClass('collapse');\n\n    });\n});\n\n// Google custom search engine javascript\n// (function() {\n//   var cx = '012656238249604753028:qzpqrvzllsa'; // Insert your own Custom Search engine ID here\n//   var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;\n//   gcse.src = (document.location.protocol == 'https' ? 'https:' : 'http:') +\n//       '//cse.google.com/cse.js?cx=' + cx;\n//   var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);\n// })();\n\n\n// function doneResizing(){$(\".drawer-marker\").toggleClass(\"is-resizing\",!1)}$(\"#gov_form\").submit(function(){var e=(new RegExp(\"/@/\",\"g\"),$(\"#gov_form input\").val());/@/g.test(e)?($(\"#gov_form select option[value=email]\").attr(\"selected\",\"selected\"),$('#gov_form input[type=\"text\"]').attr(\"id\",\"email\").attr(\"name\",\"email\"),$(\"#gov_form label\").attr(\"for\",\"email\")):($(\"#gov_form\").append('<input id=\"country_code\" name=\"country_code\" title=\"Country code\" type=\"hidden\" value=\"1\" />'),$(\"#gov_form select option[value=phone]\").attr(\"selected\",\"selected\"),$('#gov_form input[type=\"text\"]').attr(\"id\",\"phone\").attr(\"name\",\"phone\"),$(\"#gov_form label\").attr(\"for\",\"phone\"))}),$skip=$(\".mast-skip\"),$mastLogo=$(\".mast-logo\"),$menu=$(\".mast-menu\"),$menuControl=$(\".menu-control\"),$menuHeader=$(\".menu-item-header\"),$menuContent=$(\".menu-content\"),$linkHeader=$(\".menu-item-link\"),$drawers=$(\".drawer\"),$drawerHeaders=$(\".drawer-header\"),$drawerContents=$(\".drawer-content\"),$drawerFacade=$(\".drawer-facade\"),$moreDrawer=$(\".drawer-alt > .drawer-content\"),$menuControl.click(function(e){menuControlClick(e)}),$menuHeader.click(function(e){menuHeaderClick(e)}),$linkHeader.click(function(e){linkHeaderClick(e)}),$drawerHeaders.focus(function(e){drawerHeaderFocus(e)}),$drawerHeaders.blur(function(e){drawerHeaderBlur(e)}),$drawerHeaders.click(function(e){drawerHeaderClick(e)}),$skip.click(function(e){onSkip(e)}),this.lastWidth=0,this.lastHeight=0;var height,resizeId;this.isExpanded=!1,$content=$(\"#content\"),$(window).resize(function(e){$(\".drawer-marker\").toggleClass(\"is-resizing\",!0),clearTimeout(resizeId),resize(e),resizeId=setTimeout(doneResizing,500)}),setTimeout(function(){$(window).trigger(\"resize\")},1e3),this.activeDrawer=this.$drawers.eq(0),this.activeContent=this.activeDrawer.find(\".drawer-content\").eq(0),this.activeDrawer.addClass(\"is-active-drawer\"),this.isMobile=$(window).width()<720,this.isLastMobile=this.isMobile,resize=function(e){this.isLastMobile=this.isMobile,this.isMobile=$(window).width()<720,this.isMobile!==this.isLastMobile&&(this.collapseDrawer(),this.setDrawerHeight(0),this.$drawerHeaders.parent().removeClass(\"is-active\").siblings().removeClass(\"is-active\")),!this.isMobile&&this.isExpanded?this.setDrawerHeight(this.activeContent.children().outerHeight(!0)):this.setDrawerHeight(),this.lastWidth=$(window).width()},menuControlClick=function(e){this.isExpanded?(this.collapseDrawer(),this.setDrawerHeight(0)):(this.expandDrawer(),this.setDrawerHeight(100)),setTimeout(function(){$moreDrawer.attr(\"aria-hidden\",!self.isExpanded)},260)},menuHeaderClick=function(e){$(e.currentTarget).parent().toggleClass(\"is-active\").siblings().removeClass(\"is-active\")},onSkip=function(e){e.preventDefault(),$(\"#content\").find(\":focusable\").eq(0).trigger(\"focus\")},linkHeaderClick=function(e){this.collapseDrawer(),this.setDrawerHeight(0)},drawerHeaderClick=function(e){this.isMobile||e.preventDefault(),this.setActiveDrawer($(e.currentTarget))},drawerHeaderFocus=function(e){this.isMobile||e.preventDefault()},drawerHeaderBlur=function(e){this.isMobile||e.preventDefault()},setActiveDrawer=function(e){this.activeDrawer=e.parent(),this.activeContent=e.siblings(\".drawer-content\").eq(0),this.isExpanded&&this.activeDrawer.hasClass(\"is-active-drawer\")?(this.collapseDrawer(),this.setDrawerHeight(0)):(this.expandDrawer(),this.setDrawerHeight(this.activeContent.children().outerHeight(!0))),e.parent().addClass(\"is-active-drawer\").siblings().removeClass(\"is-active-drawer\")},expandDrawer=function(){this.isExpanded=!0,this.activeContent.attr(\"aria-hidden\",\"false\")},collapseDrawer=function(){this.isExpanded=!1,setTimeout(function(){$drawerContents.attr(\"aria-hidden\",\"true\")},250)},setDrawerHeightNarrow=function(e){0!==e&&(e=this.$menuContent.children().eq(0).outerHeight(!0)),this.setContentBuffer(e)},setDrawerHeight=function(e){return void 0===e?e=this.lastHeight:this.lastHeight=e,this.isMobile?void this.setDrawerHeightNarrow(e):void this.setContentBuffer(e)},\n\n// setContentBuffer=function(e){$content.css({transform:[\"translate3d(0\",e+\"px\",\"0)\"].join(\",\")}),$(\"#footer\").css({transform:[\"translate3d(0\",e+\"px\",\"0)\"].join(\",\"),\"margin-bottom\":e})};\n\nshiftContent=function(e){\n\t// $('.content, .footer').animate({ left: '+=300' }, 400);\n\t// $(\".content, .footer\").animate({\n\t//     step: function() {\n\t//         $(this).css('-webkit-transform',\"translate3d(0px, \" + e + \"px, 0px)\");\n\t//     },\n\t//     duration: 1000,\n\t//     easing: 'easeOutQuint'\n\t// });\n\t$('.content').animate({ marginTop: '+='+e+'px' }, 600, 'easeOutQuint');\n};\n\n// $('.dropdown-link').click(function(e){\n// \te.preventDefault();\n// \tvar $this = $(this);\n// \tshiftContent($this.height());\n\n// })\n\n\n// Active nav\n// console.log(atltransit.nav);\n// console.log(atltransit.nav['{{ page.category }}']);\n// $('.nav-sidebar').append('<li><a href=\"/{{ page.category }}\">{{ page.category }}</a></li>');\n// $.each(atltransit.nav['{{ page.category }}'], function(i, item){\n// \tvar activeLabel = '';\n// \tvar activeBar = '';\n// \tif ('{{ page.id }}' === item ){\n// \t\tactiveLabel = '<span class=\"sr-only\">(current)</span>';\n// \t\tactiveBar = 'class=\"active\"';\n// \t}\n// \t$('.nav-sidebar').append('<li ' + activeBar + '><a href=\"/{{ page.category }}/' + item + '\">'+item + activeLabel + '</a></li>');\n// });\n","var routeTypeMap = {\n\t\t'0': 'Tram',\n\t\t'1': 'Subway',\n\t\t'2': 'Rail',\n\t\t'3': 'Bus',\n\t\t'4': 'Ferry',\n\t\t'5': 'Cable',\n\t\t'6': 'Gondola',\n\t\t'7': 'Funicular'\n\t};\nvar currentTime = moment();\nsetupDatetime();\n\n// Schedules agency select change\n\t$('input[type=radio][name=agency-arrivals-option], #schedules-agencies').change(function(){\n\t\t$('#schedules-routes').html('<option value=\"\">[Select Route]</option>');\n\t\t$('#schedules-trips')\n\t\t\t.html('<option value=\"\">[Select Direction]</option>')\n\t\t\t.prop('disabled', true);\n\t\t$('#schedules-stops')\n\t\t\t.html('<option value=\"\">[Select Stop]</option>')\n\t\t\t.trigger('change')\n\t\t\t.prop('disabled', true);\n\t\tconsole.log(this.value);\n\t\tif (this.value === 'Nearby'){\n\t\t\t$('#get-location').trigger('click');\n\t\t\treturn true;\n\t\t}\n\t\tvar agencyId = this.value;\n\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/routes-for-agency/' + agencyId + '.json?';\n\t\tvar params = {};\n\t\t// params.id = agencyId;\n\t\tparams.key = 'TEST';\n\t\turl += serialize(params);\n\t\t$.ajax({\n\t\t\turl: url,\n\t\t\tdataType: 'jsonp',\n\t\t\tsuccess: function(json){\n\t\t\t\tconsole.log(json.data);\n\t\t\t\tvar routeNest = d3.nest()\n\t\t\t\t\t\t.key(function(d) { return d.type; })\n\t\t\t\t\t\t.sortValues(compareRouteNames)\n\t\t\t\t\t\t.map(json.data.list);\n\t\t\t\tconsole.log(routeNest);\n\t\t\t\tvar routes = json.data.list;\n\t\t\t\t$.each(routeNest, function(type, routes) {  \n\t\t\t\t\tvar optgroup = $('<optgroup>');\n\t\t\t\t\toptgroup.attr('label',routeTypeMap[type]);\n\t\t\t\t\t$.each(routes, function(i, route){\n\t\t\t\t\t\tvar option = $(\"<option></option>\");\n\t\t\t\t\t\tvar routeFullText = routeTypeMap[type] === 'Subway' ? route.shortName : route.shortName + ' - ' + route.longName;\n\t\t\t\t\t\tvar routeText = route.longName === '' ? route.shortName : routeFullText;\n\t\t\t\t\t\toption.val(route.id);\n\t\t\t\t\t\toption.text(routeText);\n\t\t\t\t\t\toptgroup.append(option);\n\t\t\t\t\t});\n\t\t\t\t\t$('#schedules-routes').append(optgroup);\n\t\t\t\t});\n\t\t\t\t$('#schedules-routes').prop('disabled', false);\n\t\t\t}\n\t\t}); // end ajax\n\t});\n\t// Use location \n\t$('#get-location').click(function(){\n\t\t$('#schedules-agencies').val('Nearby');\n\t\t$('#schedules-routes').html('<option value=\"\">[Select Route]</option>');\n\t\t$('#schedules-stops')\n\t\t\t.html('<option value=\"\">[Select Stop]</option>')\n\t\t\t.trigger('change')\n\t\t\t.prop('disabled', true);\n\t\t$('#schedules-trips')\n\t\t\t.html('<option value=\"\">[Select Direction]</option>')\n\t\t\t.prop('disabled', true);;\n\t\t$(this).val(moment().unix());\n\t\tif (geolocationBool && typeof lat !== 'undefined'){\n\t\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/routes-for-location.json?';\n\t\t\tvar params = {};\n\t\t\tparams.lat = lat;\n\t\t\tparams.lon = lon;\n\t\t\tparams.radius = 4000;\n\t\t\tparams.key = 'TEST';\n\t\t\turl += serialize(params);\n\t\t\t$.ajax({\n\t\t\t\turl: url,\n\t\t\t\tdataType: 'jsonp',\n\t\t\t\tsuccess: function(json){\n\t\t\t\t\tconsole.log(json.data);\n\t\t\t\t\tvar routeNest = d3.nest()\n\t\t\t\t\t\t.key(function(d) { return d.agencyId; })\n\t\t\t\t\t\t.map(json.data.list);\n\t\t\t\t\tconsole.log(routeNest);\n\t\t\t\t\tvar agencyCount = 0;\n\t\t\t\t\tvar firstValue;\n\t\t\t\t\t$.each(routeNest, function(agency, routes) {  \n\t\t\t\t\t\tvar optgroup = $('<optgroup>');\n\t\t\t\t\t\toptgroup.attr('label',agency);\n\t\t\t\t\t\t$.each(routes, function(i, route){\n\t\t\t\t\t\t\tvar option = $(\"<option></option>\");\n\t\t\t\t\t\t\tif (agencyCount === 0 || i === 0){\n\t\t\t\t\t\t\t\tfirstValue = route.id;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar routeFullText = routeTypeMap[route.type] === 'Subway' ? route.shortName : route.shortName + ' - ' + route.longName;\n\t\t\t\t\t\t\tvar routeText = route.longName === '' ? route.shortName : routeFullText;\n\t\t\t\t\t\t\toption.val(route.id);\n\t\t\t\t\t\t\toption.text(routeText);\n\t\t\t\t\t\t\toptgroup.append(option);\n\t\t\t\t\t\t});\n\t\t\t\t\t    $('#schedules-routes').append(optgroup);\n\t\t\t\t\t    agencyCount++;\n\t\t\t\t\t});\n\t\t\t\t\t// $('#schedules-routes').val(firstValue);\n\t\t\t\t\t$('#schedules-routes').prop('disabled', false);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse{\n\t\t\tconsole.log('no geolocation available');\n\t\t}\n\t});\n\t// Select route change\n\t$('#schedules-routes').change(function(){\n\t\tvar widgetClass;\n\t\tif ($(this).hasClass('nearby')){\n\t\t\twidgetClass = 'nearby';\n\t\t}\n\t\telse{\n\t\t\twidgetClass = 'next';\n\t\t}\n\t\twidgetClass = 'schedules';\n\t\t$('#schedules-stops')\n\t\t\t.html('<option value=\"\">[Select Stop]</option>')\n\t\t\t.trigger('change')\n\t\t\t.prop('disabled', true);\n\t\t$('#schedules-trips').html('<option value=\"\">[Select Direction]</option>');\n\t\tconsole.log(this.value);\n\t\tvar routeId = this.value;\n\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/stops-for-route/' + routeId + '.json?';\n\t\tvar params = {};\n\t\tparams.key = 'TEST';\n\t\tparams.includePolylines = false;\n\t\turl += serialize(params);\n\t\t$.ajax({\n\t\t\turl: url,\n\t\t\tdataType: 'jsonp',\n\t\t\tsuccess: function(json){\n\t\t\t\tvar closestDistance = 10000000000;\n\t\t\t\tvar closestStop = '';\n\t\t\t\tvar selectedTrip;\n\t\t\t\tvar stopGroups = json.data.entry.stopGroupings[0].stopGroups;\n\t\t\t\tconsole.log(json.data.entry.stopGroupings[0].stopGroups);\n\t\t\t\tconsole.log(json.data);\n\t\t\t\tvar stopMap = d3.nest()\n\t\t\t\t\t.key(function(d) { return d.id; })\n\t\t\t\t\t.map(json.data.references.stops);\n\t\t\t\tvar tripMap = d3.nest()\n\t\t\t\t\t// .key(function(d) { return d.name.name; })\n\t\t\t\t\t// .key(function(d) { return d.tripHeadsign; })\n\t\t\t\t\t.key(function(d) { return d.id; })\n\t\t\t\t\t.map(stopGroups);\n\t\t\t\tconsole.log(stopMap);\n\t\t\t\tconsole.log(tripMap);\n\t\t\t\tconsole.log(routeId);\n\t\t\t\tconsole.log(tripMap[routeId]);\n\t\t\t\tvar headsigns = [];\n\t\t\t\tvar tripCounter = 0;\n\t\t\t\t$.each(stopGroups, function(i, trip){\n\t\t\t\t\t// var tripId = trip.tripId;\n\t\t\t\t\t// console.log(trip);\n\t\t\t\t\t\n\t\t\t\t\t// if (typeof tripMap[routeId][tripId] !== 'undefined' && tripMap[routeId][tripId][0].routeId === routeId && headsigns.indexOf(tripMap[routeId][tripId][0].tripHeadsign) === -1){\n\t\t\t\t\t\t// var headsign = tripMap[routeId][tripId][0].tripHeadsign;\n\t\t\t\t\t\t// headsigns.push(headsign);\n\t\t\t\t\t\tvar tripLabel = trip.name.name === '' ? trip.id : trimHeadsign(trip.name.name);\n\t\t\t\t\t\ttripLabel = +tripLabel === 1 ? 'Inbound' : tripLabel;\n\t\t\t\t\t\ttripLabel = +tripLabel === 0 ? 'Outbound' : tripLabel;\n\t\t\t\t\t\tvar tripOption = $(\"<option></option>\");\n\t\t\t\t\t\ttripOption.val(trip.id);\n\t\t\t\t\t\ttripOption.text(tripLabel);\n\t\t\t\t\t\t$('#schedules-trips').append(tripOption);\n\t\t\t\t\t\tvar optgroup = $('<optgroup>');\n\t\t\t\t\t\toptgroup.attr('id', trip.id);\n\t\t\t\t\t\toptgroup.attr('label',tripLabel);\n\t\t\t\t\t\tif (tripCounter === 0){\n\t\t\t\t\t\t\tselectedTrip = trip.id;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\toptgroup.addClass('hidden-optgroup');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t$.each(trip.stopIds, function(j, stopId){\n\t\t\t\t\t\t\tvar stop = stopMap[stopId][0];\n\t\t\t\t\t\t\tconsole.log(stop)\n\t\t\t\t\t\t\tvar distance = getDistanceFromLatLonInKm(stop.lat, stop.lon, lat, lon);\n\t\t\t\t\t\t\tif (tripCounter === 0){\n\t\t\t\t\t\t\t\tif (distance < closestDistance){\n\t\t\t\t\t\t\t\t\tclosestDistance = distance;\n\t\t\t\t\t\t\t\t\tclosestStop = stop.id;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar option = $(\"<option></option>\");\n\t\t\t\t\t\t\toption.val(stop.id);\n\t\t\t\t\t\t\toption.attr('distance', distance);\n\t\t\t\t\t\t\tvar stopName = cleanStopName(stop.name);\n\t\t\t\t\t\t\tvar stopDir = stop.direction !== '' ? '(' + stop.direction + ') ' : '';\n\t\t\t\t\t\t\toption.text(stopDir + stopName);\n\t\t\t\t\t\t\toptgroup.append(option);\n\t\t\t\t\t\t\t// $('#' + widgetClass + '-arrivals-stops').append(option);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\t$('#schedules-stops').append(optgroup);\n\t\t\t\t\t\ttripCounter++;\n\t\t\t\t\t// } // end if valid trip for route\n\n\t\t\t\t}); // end each trip\n\t\t\t\tvar $stops = $('#schedules-stops');\n\t\t\t\t$('#schedules-trips').prop('disabled', false);\n\t\t\t\t$('#schedules-trips').val(selectedTrip);\n\t\t\t\t$stops.prop('disabled', false);\n\t\t\t\t$stops.val(closestStop);\n\t\t\t\tif ($stops.val() !== ''){\n\t\t\t\t\t$stops.trigger('change');\n\t\t\t\t}\n\t\t\t\tif ($('#schedules-stops').val() !== ''){\n\t\t\t\t\t$('#schedules-btn').prop('disabled', false);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t$('#schedules-btn').prop('disabled', true);\n\t\t\t\t}\n\t\t\t} // end success\n\t\t}); // end ajax\n\t});\n\tvar previousTrip;\n\t$('#schedules-trips')\n\t\t.on('focus', function () {\n\t\t\t// Store the current value on focus and on change\n\t\t\tpreviousTrip = this.value;\n\t    }).change(function(){\n\t    \tvar closestDistance = 10000000000;\n\t\t\tvar closestStop = '';\n\t\t\tconsole.log(this.value);\n\t\t\t$('#' + previousTrip).addClass('hidden-optgroup');\n\t\t\t$('#' + this.value).removeClass('hidden-optgroup');\n\t\t\t$('#' + this.value + ' > option').each(function(){\n\t\t\t\tvar distance = $(this).attr('distance');\n\t\t\t\tconsole.log(distance);\n\t\t\t\tif (distance < closestDistance){\n\t\t\t\t\tclosestDistance = distance;\n\t\t\t\t\tclosestStop = this.value;\n\t\t\t\t}\n\t\t\t});\n\t\t\tconsole.log(closestStop);\n\t\t\tvar $stops = $('#schedules-stops');\n\t\t\t$stops.val(closestStop);\n\t\t\tif ($stops.val() !== ''){\n\t\t\t\t$stops.trigger('change');\n\t\t\t}\n\t\t});\n\t$('#schedules-stops').change(function(){\n\t\tif (this.value !== ''){\n\t\t\t$('#schedules-btn')\n\t\t\t\t.removeClass('disabled')\n\t\t\t\t.removeAttr('disabled')\n\t\t\t\t.val(this.value);\n\t\t\t$('.get-realtime').removeClass('disabled');\n\t\t}\n\t\telse {\n\t\t\t$('#schedules-btn')\n\t\t\t\t.addClass('disabled')\n\t\t\t\t.attr('disabled', 'disabled')\n\t\t\t\t.val('');\n\t\t\t$('.get-realtime').addClass('disabled');\n\t\t}\n\t});\n\t$('.get-schedules').click(function(){\n\t\tvar widgetClass, stopId;\n\t\t\n\t\tif ($(this).hasClass('stop-code')){\n\t\t\twidgetClass = 'stop-code';\n\t\t}\n\t\telse{\n\t\t\twidgetClass = 'next';\n\t\t}\n\t\twidgetClass = 'schedules';\n\t\tstopId = $('#' + widgetClass + '-btn').val();\n\t\tvar routeId = $('#' + widgetClass + '-routes').val();\n\t\tconsole.log(stopId);\n\t\tconsole.log(routeId);\n\t\tconsole.log(widgetClass);\n\t\tif (stopId !== ''){\n\t\t\t// console.log('stop coding it up');\n\t\t\tvar url = 'http://atlanta.onebusaway.org/api/api/where/schedule-for-stop/' + stopId + '.json?';\n\t\t\tvar params = {};\n\t\t\tparams.key = 'TEST';\n\t\t\tparams.minutesBefore = 1;\n\t\t\turl += serialize(params);\n\t\t\t$.ajax({\n\t\t\t\turl: url,\n\t\t\t\tdataType: 'jsonp',\n\t\t\t\tsuccess: function(json){\n\t\t\t\t\tvar routes = json.data.entry.stopRouteSchedules;\n\t\t\t\t\tconsole.log(json.data);\n\t\t\t\t\tvar stopMap = d3.nest()\n\t\t\t\t\t\t.key(function(d) { return d.id; })\n\t\t\t\t\t\t.map(json.data.references.stops);\n\t\t\t\t\tvar routeMap = d3.nest()\n\t\t\t\t\t\t.key(function(d) { return d.id; })\n\t\t\t\t\t\t.map(json.data.references.routes);\n\t\t\t\t\tconsole.log(routeMap);\n\t\t\t\t\tconsole.log(json.data.entry.stopRouteSchedules);\n\t\t\t\t\tif (routes.length > 0){\n\t\t\t\t\t\tstopName = stopMap[json.data.entry.stopId][0].name;\n\t\t\t\t\t\t$('#' + widgetClass + '-stop-code').html(cleanStopName('Stop ID: ' + stopId.split('_')[1]));\n\t\t\t\t\t\t$('#' + widgetClass + '-stop-name').html(cleanStopName(stopName));\n\t\t\t\t\t\t// $('#' + widgetClass + '-last-updated').html('<a class=\"get-arrivals next btn\"><span class=\"glyphicon glyphicon-refresh\" aria-hidden=\"true\"></span> ' + moment(arrivals[0].lastUpdateTime).format('h:mm a') + '</a>');\n\t\t\t\t\t\t$('#nearby-arrival-msg').hide();\n\t\t\t\t\t\tvar data = [];\n\t\t\t\t\t\tvar schedulesDiv = $('.schedules-tables');\n\t\t\t\t\t\tvar rowDiv = $('<div class=\"row\"></div>');\n\t\t\t\t\t\tvar rowDiv2 = $('<div class=\"row\"></div>');\n\t\t\t\t\t\tschedulesDiv.empty();\n\t\t\t\t\t\tfor (var i = 0; i < routes.length; i++) {\n\t\t\t\t\t\t\tconsole.log(routes[i]);\n\t\t\t\t\t\t\tvar routeName = routeMap[routes[i].routeId][0].shortName;\n\t\t\t\t\t\t\tvar directions = routes[i].stopRouteDirectionSchedules;\n\t\t\t\t\t\t\tfor (var j = 0; j < directions.length; j++) {\n\t\t\t\t\t\t\t\tvar numTrips = directions.length * routes.length;\n\t\t\t\t\t\t\t\tvar gridWidth = numTrips > 4 ? 3 : 12 / numTrips;\n\t\t\t\t\t\t\t\tgridWidth = numTrips === 1 ? 6 : gridWidth;\n\t\t\t\t\t\t\t\tgridWidth = 6; // modified gridWidth for narrow layout\n\t\t\t\t\t\t\t\tvar gridWidthSm = numTrips > 4 ? 6 : 12 / numTrips * 2;\n\t\t\t\t\t\t\t\t// var tableId = '#' + widgetClass + '-table';\n\t\t\t\t\t\t\t\tvar columnDiv = $('<div class=\"schedule-table table-responsive col-xs-12 col-md-'+gridWidth+' col-sm-6\"></div>')\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar table = $('<table class=\"table table-striped table-condensed table-hover col-md-'+gridWidth+'\" id=\"schedule-'+routeId+j+'\"></table>');\n\n\t\t\t\t\t\t\t\ttable.append('<thead><tr><th class=\"text-right\">Hour</th><th>Minute</th></tr></thead>');\n\t\t\t\t\t\t\t\tvar tbody = $('<tbody>');\n\t\t\t\t\t\t\t\tvar headsign = trimHeadsign(directions[j].tripHeadsign);\n\t\t\t\t\t\t\t\tif (directions[j].scheduleFrequencies.length > 0){\n\t\t\t\t\t\t\t\t\tconsole.log('freq based');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tconsole.log('sched based');\n\t\t\t\t\t\t\t\t\tconsole.log(directions[j].scheduleStopTimes);\n\t\t\t\t\t\t\t\t\tvar stopTimes = directions[j].scheduleStopTimes;\n\t\t\t\t\t\t\t\t\tvar firstTime = moment(stopTimes[0].arrivalTime);\n\t\t\t\t\t\t\t\t\tvar currentHour = 0;\n\t\t\t\t\t\t\t\t\tvar row;\n\t\t\t\t\t\t\t\t\tvar minuteCell;\n\t\t\t\t\t\t\t\t\tvar morning = firstTime.hour() < 12 ? true : false;\n\t\t\t\t\t\t\t\t\tfor (var k = 0; k < stopTimes.length; k++) {\n\t\t\t\t\t\t\t\t\t\tvar meridian = '';\n\t\t\t\t\t\t\t\t\t\tif (morning && k === 0){\n\t\t\t\t\t\t\t\t\t\t\t// tbody.append('<tr class=\"text-left warning\"><td colspan=\"2\"><strong>AM</strong></td></tr>');\n\t\t\t\t\t\t\t\t\t\t\tmeridian = '<strong>AM</strong>  ';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tvar seconds = stopTimes[k].arrivalTime;\n\t\t\t\t\t\t\t\t\t\t// console.log(seconds);\n\t\t\t\t\t\t\t\t\t\tvar arrivalTime = moment(seconds);\n\t\t\t\t\t\t\t\t\t\tvar arrivalTimeMinutes = arrivalTime.minutes() < 10 ? '0' + arrivalTime.minutes() : arrivalTime.minutes();\n\t\t\t\t\t\t\t\t\t\tvar nextArrivalTime;\n\t\t\t\t\t\t\t\t\t\tif (k !== stopTimes.length - 1){\n\t\t\t\t\t\t\t\t\t\t\tnextArrivalTime = moment(stopTimes[k + 1].arrivalTime);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t// console.log(arrivalTime.format('h:mm a'));\n\t\t\t\t\t\t\t\t\t\tif (arrivalTime.hour() !== currentHour){\n\t\t\t\t\t\t\t\t\t\t\t// console.log(arrivalTime.hour())\n\t\t\t\t\t\t\t\t\t\t\t// console.log(currentHour)\n\t\t\t\t\t\t\t\t\t\t\t// if (arrivalTime.hour() > firstTime.hour()){\n\t\t\t\t\t\t\t\t\t\t\t// \ttbody.append($('.' +i+j+arrivalTime.hour()));\n\t\t\t\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t\t\t\trow = $('<tr id=\"'+i+j+arrivalTime.hour()+'\">');\n\t\t\t\t\t\t\t\t\t\t\tif (arrivalTime.hour() >= 12 && morning){\n\t\t\t\t\t\t\t\t\t\t\t\tmorning = false;\n\t\t\t\t\t\t\t\t\t\t\t\ttbody.append('<tr class=\"blank_row\"><td colspan=\"2\"></td></tr>');\n\t\t\t\t\t\t\t\t\t\t\t\tmeridian = '<strong>PM</strong>  ';\n\t\t\t\t\t\t\t\t\t\t\t\t// tbody.append('<tr class=\"text-left info\"><td colspan=\"2\"><strong>PM</strong></td></tr>');\n\t\t\t\t\t\t\t\t\t\t\t\t// row.append('<td>PM</td>');\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\trow.append('<td class=\"text-right\"><strong>' + meridian + arrivalTime.format('h') + ':</strong></td>');\n\t\t\t\t\t\t\t\t\t\t\tminuteCell = $('<td class=\"text-left\">' + arrivalTimeMinutes + '</td>');\n\t\t\t\t\t\t\t\t\t\t\trow.append();\n\t\t\t\t\t\t\t\t\t\t\tcurrentHour = arrivalTime.hour();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\tminuteCell.append(' ' + arrivalTimeMinutes);\n\t\t\t\t\t\t\t\t\t\t\t// console.log($('.'+i+j+'-hour-'+arrivalTime.hour()).html());\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif (nextArrivalTime.hour() !== arrivalTime.hour()){\n\t\t\t\t\t\t\t\t\t\t\trow.append(minuteCell);\n\t\t\t\t\t\t\t\t\t\t\ttbody.append(row);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif (k == stopTimes.length - 1){\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('done')\n\t\t\t\t\t\t\t\t\t\t\ttable.append(tbody);\n\t\t\t\t\t\t\t\t\t\t\t// console.log(table);\n\t\t\t\t\t\t\t\t\t\t\tcolumnDiv\n\t\t\t\t\t\t\t\t\t\t\t\t.append('<h4><span class=\"'+labelMap[routeName]+'\">' + routeName + '</span> - ' + headsign +'</h4')\n\t\t\t\t\t\t\t\t\t\t\t\t.append(table);\n\t\t\t\t\t\t\t\t\t\t\tif ( i > 1 ){\n\t\t\t\t\t\t\t\t\t\t\t\trowDiv2\n\t\t\t\t\t\t\t\t\t\t\t\t\t.append(columnDiv);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\t\t\t\trowDiv\n\t\t\t\t\t\t\t\t\t\t\t\t\t.append(columnDiv);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tschedulesDiv\n\t\t\t\t\t\t\t\t\t\t\t\t.append(rowDiv)\n\t\t\t\t\t\t\t\t\t\t\t\t.append(rowDiv2);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// var predicted = routes[i].predictedArrivalTime ? true : false;\n\t\t\t\t\t\t\t// var seconds = routes[i].predictedArrivalTime || routes[i].scheduledArrivalTime;\n\t\t\t\t\t\t\t// var diff = seconds - moment().valueOf();\n\t\t\t\t\t\t\t// var routeName = routes[i].routeShortName;\n\t\t\t\t\t\t\t// var fromNow = Math.floor(diff/60/1000);//moment(seconds).toNow(true)//.replace('minutes', '').replace('a few seconds', '<strong>NOW</strong>').replace('a minute', '<strong>NOW</strong>');\n\t\t\t\t\t\t\t// var fromNowText = fromNow <= 1 ? '<strong>NOW</strong>' : fromNow;\n\t\t\t\t\t\t\t// var headsign = trimHeadsign(routes[i].tripHeadsign);\n\t\t\t\t\t\t\t// var patt = new RegExp(\"Airport\");\n\t\t\t\t\t\t\t// if (patt.test(headsign)){\n\t\t\t\t\t\t\t// \theadsign += ' <i class=\"fa fa-plane\"></i>';\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t// var row = $('<tr class=\"info\">');\n\t\t\t\t\t\t\t// if (predicted){\n\t\t\t\t\t\t\t// \tfromNowText += ' <i style=\"font-size:0.7em;\" alt=\"Predicted arrival time\" title=\"Predicted arrival time\" class=\"fa fa-bolt\"></i>';\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t// row.append('<td><span class=\"'+labelMap[routeName]+'\">' + routeName + '</span></td>');\n\t\t\t\t\t\t\t// row.append('<td data-order=\"'+fromNow+'\">' + fromNowText + '</td>');\n\t\t\t\t\t\t\t// row.append('<td>' + headsign + '</td>');\n\t\t\t\t\t\t\t// tbody.append(row);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tconsole.log(data);\n\t\t\t\t\t\t// if ( $.fn.dataTable.isDataTable(tableId) ) {\n\t\t\t\t\t\t// \tarrivalsDatatable = table.DataTable();\n\t\t\t\t\t\t// \t// arrivalsDatatable.clear();\n\t\t\t\t\t\t// \t// arrivalsDatatable.rows.add(data);\n\t\t\t\t\t\t// \t// arrivalsDatatable.draw();\n\t\t\t\t\t\t// \tarrivalsDatatable.destroy();\n\t\t\t\t\t\t// }\n\t\t\t\t\t\t// else {\n\t\t\t\t\t\t\t// arrivalsDatatable = table.DataTable( {\n\t\t\t\t\t\t\t// \t\"order\": [[ 1, \"asc\" ]],\n\t\t\t\t\t\t\t// \t// \"columns\": [\n\t\t\t\t\t\t\t// \t// \t{\"title\": \"Route\"},\n\t\t\t\t\t\t\t// \t// \t{\"title\": \"Minutes\"},\n\t\t\t\t\t\t\t// \t// \t{\"title\": \"Direction\"},\n\t\t\t\t\t\t\t// \t// \t{\"title\": \"diff\", \"type\": \"num\"}\n\t\t\t\t\t\t\t// \t// ],\n\t\t\t\t\t\t\t// \t// \"columnDefs\": [\n\t\t\t\t\t\t\t// \t// \t// \"targets\": [ 2 ],\n\t\t\t\t\t\t\t// \t// \t// \"visible\": false\n\t\t\t\t\t\t\t// \t// \t// { \"type\": \"num\", \"targets\": 0 }\n\t\t\t\t\t\t\t// \t// \t{ \"visible\": false, \"targets\": 3 },\n\t\t\t\t\t\t\t// \t// \t// { \"orderData\": 1,    \"targets\": 3 },\n\t\t\t\t\t\t\t// \t// ],\n\t\t\t\t\t\t\t// \t// \"data\": data,\n\t\t\t\t\t\t\t// \t\"paging\": false,\n\t\t\t\t\t\t\t// \t// \"pageLength\": 6,\n\t\t\t\t\t\t\t// \t// \"ordering\": false,\n\t\t\t\t\t\t\t// \t\"info\": false,\n\t\t\t\t\t\t\t// \t\"bFilter\": false\n\t\t\t\t\t\t\t// });\n\t\t\t\t\t\t// }\n\t\t\t\t\t} // end if there are arrivals in the list\n\t\t\t\t\t// else{\n\t\t\t\t\t// \ttable.hide();\n\t\t\t\t\t// \t$('#' + widgetClass + '-stop-name').html('');\n\t\t\t\t\t// \t$('#' + widgetClass + '-last-updated').html('');\n\t\t\t\t\t// \t$('#' + widgetClass + '-arrival-msg').text('No arrivals in the next 30 minutes.');\n\t\t\t\t\t// \t$('#' + widgetClass + '-arrival-msg').show();\n\t\t\t\t\t// }\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t$('#schedules-carousel').carousel('next');\n\t});"],"sourceRoot":"/source/"}